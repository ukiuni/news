---
  layout: post
  title: "Zero-dependency genetics engine in vanilla PHP: 14 loci, sex-linked inheritance, Cartesian product for 10,000+ phenotype combinations - バニラPHPで動く依存ゼロの遺伝学エンジン：14遺伝子座・性染色体遺伝・カルテシアン積で1万超の表現型"
  date: 2026-01-03T06:38:26.406Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "https://github.com/kanarazu-project/gene-forge"
  source_title: "GitHub - kanarazu-project/gene-forge: Agapornis Genetics Calculator - ALBS Compliant Edition"
  source_id: 472331725
  excerpt: "バニラPHPで14遺伝子座・性染色体の1万超表現型を瞬時算出、軽量最適化済み"
  image: "https://opengraph.githubassets.com/03bed06a79af1ef14d8b1dbf1ec7a690e49e19fb8ac85064d357eebe93974dbc/kanarazu-project/gene-forge"
---

# Zero-dependency genetics engine in vanilla PHP: 14 loci, sex-linked inheritance, Cartesian product for 10,000+ phenotype combinations - バニラPHPで動く依存ゼロの遺伝学エンジン：14遺伝子座・性染色体遺伝・カルテシアン積で1万超の表現型

魅力的な日本語タイトル: バードブリーディングを一変させる軽量PHP遺伝エンジン — 14遺伝子座で何万通りも瞬時に計算する方法

## 要約
GitHubの「Gene‑Forge」は、外部依存なしのバニラPHPで愛鳥（Agapornis）向けの遺伝計算を実装したエンジンで、14の遺伝子座を扱い性染色体遺伝や累積近親係数まで正確に算出する。小規模サーバーでも何万通りの表現型確率を高速に生成できる点が特徴。

## この記事を読むべき理由
日本のブリーダー、鳥類研究者、あるいは遺伝計算ライブラリを自前で組み込みたいエンジニアにとって、外部ライブラリに頼らない軽量で移植しやすい設計は実用価値が高い。特に「性リンク（Z/W）」「多重アレル」「近親係数累積評価」といった実務で重要な機能をワンパッケージで確認できるため、実装・評価・教育用途に有用です。

## 詳細解説
- アーキテクチャ概要  
  Gene‑Forgeはロジックとデータを分離し、主要ロジックを genetics.php に集中させたシンプルな構成。フロントはHTML/JS、計算は純粋なPHP配列操作で完結するため、PHP 7.4+ があれば即動作します。

- 14遺伝子座と並列独立性  
  各遺伝子座は独立した確率イベントとしてPunnettの組合せを個別に計算し、最終的な全遺伝子座の組合せ分布はカルテシアン積（直積）で統合します。これにより「多遺伝子・多アレル」の爆発的組合せを理論的に扱いますが、実装は配列演算のみで最適化されています。

- 性染色体（ZZ/ZW）への対応  
  鳥類特有の性決定（オス：ZZ、メス：ZW）を正確に扱います。オスは2アレルで「split（保因）」状態があり、メスはZ染色体が1つ（ヘミジゴート）なので表現型が直接決まる点を演算ロジックで分離しています。

- 表現型解決の階層（Genotype → Phenotype）  
  アレルは文字列で管理（例：aqaq, +tq など）。優先順位（Tier）ルールに従って、生成された遺伝子組合せを310種類以上の色名に一貫してマッピングします。これにより複合カラーを動的に命名できます。

- 近親係数（WrightのF）の累積計算  
  系統を最大6世代までたどり、共通祖先ごとに貢献度を合算します。教科書的な単純値と違い、祖先がすでに近交系である場合を考慮した「累積F」を出力します。数式は次の通りです  
  $$
  F = \sum (1/2)^{n_1 + n_2 + 1}
  $$  
  （n1, n2 はそれぞれ雄・雌から共通祖先までの世代数）。実務上、これに基づいてINOやPallidなど危険閾値でペアリングをロックします。

- 家系推定エンジン（FamilyEstimator V3）  
  出現する劣性表現型やきょうだい情報を使って、親の保因状態を確率的に収束させる逆推論機能を搭載。ベイジアン風の制約合成で世代横断的に一貫した遺伝子割当を導出します。

- 性能設計とデモ  
  依存なしでミリ秒単位応答を目指しており、66個のデモ個体（3家族）で各機能の検証が可能。API（infer.php等）経由で家系推定やオフスプリング予測が呼べます。

- 拡張性  
  LOCI定義を差し替えるだけで他種への移植が可能。遺伝様式（AR/SLR/AIDなど）を設定すれば、Budgerigarなど別種にも対応できる設計です。

## 実践ポイント
- ローカルで試す（すぐできる）  
  1) リポジトリをクローン  
  2) php -S localhost:8000 で起動 → ブラウザで確認  
  まずはdemoデータで健康評価・表現型予測を試す。

- 既存システムへの組込み  
  genetics.php を単一のSSOT（single source of truth）としてラップすれば、Rails/Node.js等のバックエンドからもHTTP API経由で利用可能。計算ロジックはステートレスなのでコンテナ化も容易。

- 日本市場での応用例  
  - 小規模ブリーダー向けのオンプレミスアプリ（個人情報・血統情報の取り扱いが重要）  
  - 教育用途（遺伝学の演習）：実際の多遺伝子ケースを可視化できるため教材に最適  
  - 他の家禽種への拡張：LOC I定義を置き換えれば比較的短期間で移植可能

- 注意点（倫理と実務）  
  近親交配評価はあくまで確率とリスク指標。実際の飼育判断は獣医や協会ガイドラインに従うこと。特にINO/Pallidなど致命的な欠点を引き起こす遺伝子はペアリング制限を厳格に扱うべきです。

- 開発者向けヒント  
  - 大きなカルテシアン積を扱う場合はメモリとレスポンスを監視（必要なら逐次化処理で分割）  
  - テストデータ（demo）をベースにユニットテストを書き、推論エンジンの収束挙動を検証すること

以上を踏まえれば、Gene‑Forgeは「手軽に始められて、実務的な精度を備えた」遺伝計算フレームワークとして日本の開発者・ブリーダー双方にとって価値の高い出発点になります。興味があれば、まずはリポジトリをローカルで立ち上げてデモの挙動を触ってみてください。
