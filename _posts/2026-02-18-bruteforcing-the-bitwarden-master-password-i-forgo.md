---
layout: post
title: "Bruteforcing the Bitwarden master password I forgor - 忘れたBitwardenマスターパスワードを総当たりで取り戻した話"
date: 2026-02-18T23:35:58.135Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://compilercrim.es/forgor/"
source_title: "Bruteforcing the Bitwarden master password I forgor 💀"
source_id: 1727399750
excerpt: "ローカル検証データで失ったBitwardenマスターを総当たりで復旧し、KDF設計の盲点を暴いた実録"
image: "https://compilercrim.es/icon.png"
---

# Bruteforcing the Bitwarden master password I forgor - 忘れたBitwardenマスターパスワードを総当たりで取り戻した話
忘れたパスフレーズを“運良く”ローカル検証で取り戻した、エンジニアの赤裸々リカバリー記

## 要約
パスフレーズの一語だけ忘れた作者が、ローカルに残る検証データとパスフレーズ生成条件を解析して漏れを補完し、結果的に総当たりで復旧した経験談とそこから見えた暗号設計上の問題点を整理する。

## この記事を読むべき理由
パスワード管理の普及で「自分のパスフレーズを忘れる」ケースは現実的なリスクです。本件は単なる失念話ではなく、実務で使われるKDF設計やローカル／サーバー側のハッシュ設計が持つ落とし穴を示しており、日本のエンジニアや運用者にとって有益な教訓になります。

## 詳細解説
- 背景：作者はxkcdスタイルの語彙ベースなパスフレーズを長年使っており、ある日一語だけ思い出せなくなった。全デバイスでログイン済みだったため、ローカルに残る検証情報を使って欠けた語を埋められないかと考えた。
- パスフレーズ候補の絞り込み：語彙生成の方式（候補数が限られる単語リスト）というメタ情報があったため、総当たりの範囲は理論上小さかった。これが「実用的な復旧」を可能にした重要な要因。
- KDF と検証フローの挙動：Bitwarden系クライアントはパスワードからマスターキーを生成するためにキー伸張（PBKDF2またはArgon2id）を使い、その後さらにハッシュを取りローカル保存用／サーバー認証用に使い分けている。設計上は「ローカル検証」と「サーバー認証」を分離する意図があるが、実装方法次第で副作用（両者のハッシュ間に利用しやすい関係が生まれる）が生じる。
- 設計上の問題点：記事の筆者は「KDFの繰り返し回数（iterations）をドメイン分離の手段として使う」ことを批判している。繰り返し回数は性能と抵抗力の調整に使うべきで、ドメイン分離の主目的に据えると脆弱さや誤用を招きやすい。安全な分離には明確なドメイン区別（別の鍵導出ラベルや異なるKDFパラメータ設計）を使うべきだ。
- 脅威モデルの示唆：サーバー側の認証ログ（ハッシュ）を入手し、かつ現地でローカルの検証データも取得できるような強い脅威モデルでは、ある実装だと攻撃者が候補を効率よく検証できる可能性が出てくる。したがって実装の細部が安全性に直結する。

## 実践ポイント
- パスフレーズ設計：語彙系パスフレーズは覚えやすいが、候補空間が小さいと総当たりに脆弱。長さと予測不能性を優先する（短い語数＋既知語リスト依存は再考を）。
- KDF選択とパラメータ：可能ならArgon2id等のメモリ重視KDFを採用し、適切なパラメータで運用する。KDFパラメータをドメイン分離の代替にしない。
- 実装の原則：ローカル検証用とサーバー認証用は、別々の目的に合わせて明示的に分離（別ラベル／別KDF入力など）する。繰り返し回数だけで区別するのは危険。
- 運用対策：Vaultを常時ログイン状態で放置しない、デバイスのフルディスク暗号化とロック運用を徹底する、緊急アクセスやリカバリ手段を用意する。
- 監査観点：自社や利用しているツールのKDF実装・ハッシュ化設計を確認し、ドメイン分離やパラメータの使い方に問題がないかレビューする。

作者の体験は「幸運に助けられた復旧例」であり、同時に設計上の教訓も提供している。覚えやすさと安全性のバランス、そして実装の細部が実際の安全性を左右することを改めて示す話だ。
