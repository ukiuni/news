---
layout: post
title: "Make.ts - make.ts（インタラクティブスクリプトの運用パターン）"
date: 2026-01-28T08:12:51.075Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://matklad.github.io/2026/01/27/make-ts.html"
source_title: "make.ts"
source_id: 46792194
excerpt: "make.tsでターミナル分割をやめ、ファイルで実験・ベンチを再現・並列自動化する方法"
---

# Make.ts - make.ts（インタラクティブスクリプトの運用パターン）
魅力的なタイトル: もうターミナルを分割しない。`make.ts`で実験・ベンチを「ファイル」で再現するワークフロー

## 要約
コマンド履歴に頼らず、インタラクティブな操作を都度ファイル（例: make.ts）に書いて実行することで、再現性・拡張性・並列実行が格段に上がるという手法の紹介。

## この記事を読むべき理由
複数プロセスやクラウド上の実験を行う日本の開発現場でも、手作業の再現性欠如やターミナル分割の煩雑さがボトルネックになりがち。本手法は短時間で実用的な自動化へ移行でき、結果の再現やCI化も容易にします。

## 詳細解説
- 根本アイデア: まずターミナルで打つ代わりに `make.ts` にコマンドを書き、`./make.ts` で実行。インタラクティブ→永続ファイルの漸進的進化により、最初から“完成したスクリプト”を作る必要はない。
- フォーマット: 固定名（`make.ts`）をプロジェクトルートに置き、`.git/info/exclude` に追加してコミットしない運用が便利。シェバン＋実行権限でワンコマンド実行を可能にする。
- 言語とライブラリ: セットアップが軽くプロセス生成・並列処理が扱いやすい言語が最適。作者は TypeScript + Deno + dax を推奨。Bun や zx も選択肢だが、zx はシェル経由になる点に注意。
- テクニカルポイント:
  - タグ付きテンプレートがコマンド引数配列の扱いに適している（安全に exec に渡せる）。
  - `async/await` と `Promise.all` で複数プロセスを同時に扱える。
  - 実験中にログをファイルへ流し、必要なときだけ別ターミナルで `tail -f` する運用が現実的。
  - 漸進的に関数化・パラメータ化してベンチマトリクスを回せる。

## 実践ポイント
- ファイル作成と実行権限付与（例）
```typescript
#!/usr/bin/env -S deno run --allow-all
```
- 簡単なコマンド呼び出し（dax風）
```typescript
// typescript
await $`./build && ./deploy`;
```
- 並列実行の例
```typescript
// typescript
await Promise.all([
  $`server --start`,
  $`client --bench`
]);
```
- パラメータ化してループ実行
```typescript
// typescript
for (const ver of ["baseline","latest"]) {
  await benchmark(ver);
}
```
- 運用tips: `./make.ts` をシェル履歴に残しておく（autosuggest に便利）、VS Code タスクや terminal-editor をワンクリック起動に登録、ログは `logs/` に出力して `tail -f` で監視。

まずは小さな `make.ts` を作ってみてください。数回の実行で、手作業より確実に効率が上がります。
