---
layout: post
title: "Walkthrough of X's algorithm that decides what you see - Xが何を見せるかを決めるアルゴリズムの解説"
date: 2026-01-28T19:05:18.864Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://codepointer.substack.com/p/x-algorithm-how-x-decides-what-550"
source_title: "[x-algorithm] How X Decides What 550 Million Users See"
source_id: 415236343
excerpt: "コード解析で判明：Xは18種の行動確率と滞在予測であなたに何を見せるか決める"
image: "https://substackcdn.com/image/fetch/$s_!VIuo!,w_1200,h_675,c_fill,f_jpg,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc75bb5c9-d54f-40f8-97b2-92a1f9ce1947_1536x805.png"
---

# Walkthrough of X's algorithm that decides what you see - Xが何を見せるかを決めるアルゴリズムの解説
Xが550Mユーザーに何を見せるかを決める「中身」をコードから読み解く

## 要約
Xが公開したフィード推薦のコードを分解すると、「取得→分類→前処理→スコアリング→選出」という明確なパイプラインで投稿が絞り込まれ、18種類の行動確率や滞在時間予測を組み合わせて最終順位を決めていることが分かる。

## この記事を読むべき理由
日本のクリエイター、プロダクトエンジニア、モデレーター、広告担当者にとって、どのシグナルが可視性を左右するかを理解することは、コンテンツ戦略やプラットフォーム設計、規制対応に直結するため必読です。

## 詳細解説
- アーキテクチャ概観  
  - CandidatePipeline：モジュール化された推奨パイプライン。各ステージ（Source, Hydrator, Scorer, Filter）が独立して連携する。  
- ステージ1：候補取得（Retrieval）  
  - Thunder（インネットワーク）：フォロー先の直近48時間分をメモリ構造（DashMap）で高速取得。O(1) の投稿索引あり。  
  - Phoenix（発見／OON）：二塔（two-tower）モデル。ユーザ塔はGrokトランスフォーマー＋平均プーリング、候補塔は2層MLP。L2正規化した埋め込みでドット積検索（ANNで高速化）。リクエスト時にユーザ埋め込みを生成して大規模コーパスを照会。  
- ステージ2：In-Network 判定  
  - Hydratorがフォロー集合でO(1) 判定を行い、in_networkフラグを付与。発見経路でもフォロー先ならインネット扱いに。分類をスコアリングから独立させる設計。  
- ステージ3：事前フィルタリング  
  - 重複除去、欠損データ除外、年齢制限、自己投稿除外、鍵垢非表示、既視・セッション済み除外、ミュートキーワード・ブロック適用など（合計約10個の連続フィルタ）。  
- ステージ4：スコアリング（競争）  
  - (4.1) Phoenixが18種類のエンゲージメント確率（like/retweet/reply/クリック/プロフィール遷移/動画完視聴など）と連続値のdwell_timeを一度のフォワードで予測。  
  - バッチ独立性：各候補が同バッチの他候補に影響しないように特殊な注意マスク（make_recsys_attn_mask）で隔離。  
  - (4.2) WeightedScorerで各確率とメトリクスを重み付けして単一スコアに集約（ブロック等は負の重み）。  
  - (4.3) Author Diversity：同一作者の連続露出を指数減衰（floorパラメータで完全排除はしない）。  
  - (4.4) Out-of-Networkペナルティ：非フォロー投稿は係数（例0.7）で減衰。  
- ステージ5：選出と最終フィルタ  
  - TopK選定後、外部の可視性サービスで安全性ラベル判定（タイムラインと推薦で異なる厳格さ）。フラグが付けば除外。会話スレッド単位での重複除去（最もスコアの高い投稿のみ残す）。  
- 設計上の挙動メモ  
  - スコアはリクエストごとに再計算され、時間とともにエンゲージメントが増えると再評価で順位が変わる。早期のポジティブ反応がフィードバックループを生み、量的優位が否定的シグナルを相殺し得る（いわゆる「炎上の拡散」の仕組み）。  
  - 引用リツイート（quote）はアルゴリズム上は正の共有シグナルとして扱われ、批判的引用も分離されにくい。

## 日本市場との関連
- 日本語固有の埋め込み・トークン化（形態素解析やサロゲート表現）やローカルなコミュニティ特性（少人数だが高エンゲージメント）で、Phoenixの検索・類似性は英語圏と異なる挙動を示す可能性あり。  
- ニュースや政治的話題での「量が質を凌駕する」問題は、日本のデマ拡散や炎上にも直結。可視性サービスとモデレーションのポリシー設計が重要。  
- 広告・マーケ担当は「どのシグナルを高めると露出が上がるか」を把握してKPI設計を見直すべき。

## 実践ポイント
- クリエイター／運用者向け  
  - ポジティブなエンゲージメント（いいね・リプ・シェア・動画完視聴）を増やす設計を優先する。タイトルやサムネでクリックと滞在を高める。  
  - ブロックや報告を誘発しない表現、誤解を招かないメタデータ（テキストの完全性）を心がける。  
  - アカウント分散や投稿の多様化で作者デイケイの影響を緩和する。  
- エンジニア／プロダクト向け  
  - 検索はANN、埋め込みはL2正規化、バッチ独立性は注意マスクで実現する。HydratorとScorerを分離すると拡張性が高い。  
  - 可視性判定は外部サービス化してパイプラインから独立させると柔軟。  
- モデレーション／政策担当向け  
  - 早期のポジティブ信号が拡散を加速するため、問題投稿の初動検知と迅速な可視性調整が重要。言語・文化差を踏まえた判定基準を設計する。  

短くまとめると、「何が見えるか」は取得→フィルタ→精密スコアリングの積み重ねで決まり、ポジティブな行動確率を高めつつネガティブシグナルを避けることが、露出改善の近道です。
