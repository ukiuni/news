---
layout: post
title: "A 0-click exploit chain for the Pixel 9, part 1: Decoding Dolby - Pixel 9 の 0 クリック脆弱性連鎖（パート1）：Dolby を解読する"
date: 2026-01-16T05:53:34.517Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://projectzero.google/2026/01/pixel-0-click-part-1.html"
source_title: "A 0-click exploit chain for the Pixel 9 Part 1: Decoding Dolby - Project Zero"
source_id: 1152527722
excerpt: "Pixel 9のDolbyデコーダ欠陥で0クリック端末乗っ取り、手口と対策を詳細解説"
---

# A 0-click exploit chain for the Pixel 9, part 1: Decoding Dolby - Pixel 9 の 0 クリック脆弱性連鎖（パート1）：Dolby を解読する
誰でも開ける扉 — Pixel 9 の「0クリック」侵害を可能にしたDolbyデコーダの弱点を読み解く

## 要約
Google Project Zero が公開した調査では、Google Messages が自動デコードする音声添付（Dolby/DD+）の処理で、ユーザー操作なしにコード実行可能な脆弱性（CVE-2025-54957）が見つかり、Pixel 9 を標的にした 0クリックの攻撃連鎖が構築できることが示されました。該当脆弱性は 2026-01-05 に修正済みです。

## この記事を読むべき理由
- 0クリック攻撃は受信するだけで端末が危険にさらされるため、スマホ利用者・運用者にとって即時のリスクです。  
- 日本でも Android とメッセージング→自動解析（文字起こし等）機能は普及中。技術的な仕組みと対策を理解しておく価値があります。

## 詳細解説
ポイントを平易に整理します。

- 何が問題か：Dolby Unified Decoder（UDC）は DD / DD+ 音声を解析するライブラリ。Google Messages が受信音声を自動的にデコードするため、デコーダは「0クリック」攻撃対象になります。  
- 仕様と実装の噛み合わせ：DD+ のフレームには「syncframe」単位で EMDF（拡張メタデータ）というペイロードが含まれます。仕様上、EMDF の各ペイロード長を可変長エンコード（variable_bits）で表現しますが、実装側にペイロード長の上限チェックが無く、任意に大きな値を読み取れてしまいます。  
- 具体的な脆弱性（要点）：
  1. evo ヒープという固定スラブ上でメモリ確保を行う関数に整数オーバーフローがあり、非常に大きな要求サイズで total_size がラップして小さな割当になってしまいます。  
  2. 割当後にペイロードサイズ分だけバイトを書き込む処理があり、書き込み長は制御可能（ただし上限あり）で、「バッファ上書き（overrun）」が発生します。  
  3. 別に「リーク能」もあり、EMDF の宣言サイズ（emdf_container_length）を読み取ってビットリーダーに設定するため、初期化されていない領域を読み出せる場合があります。単独では致命的でないが、上書きと組み合わせると有用な情報（メモリ内容）を取り出せます。  
  4. メモリ配置（static/dynamic buffers）を解析し、複数の小さな EMDF ペイロードで evo ヒープを部分的に埋め、次に overrun を起こすことで「スキップポインタ」を上書きし、任意の書き込みへ繋げる手法が設計されました。これにより、mediacodec コンテキストでの任意コード実行が可能になった、というのが本稿（パート1）の核心です。
- 攻撃の制約と次の段階：ASLR 等の緩和策があるため、完全支配には追加の権限昇格（カーネルやドライバを狙うパート2の脆弱性）を組み合わせる必要があります。Project Zero は実際に Pixel 9 で連鎖攻撃を作り上げ、これらを順を追って公開しています。

## 実践ポイント
- すぐやること（一般ユーザー）：
  - Pixel 9 を含む端末で、OS・ベンダーのセキュリティアップデートを適用する（2026-01-05 修正済）。  
  - メッセージアプリの「自動デコード／自動文字起こし」機能が切れる設定があれば一時的に無効化する。  
- 開発者・運用者向け：
  - メディアコーデックや外部バイナリ（vendor blobs）は特に入念に境界チェック・整数オーバーフロー対策を行う。可変長エンコードの上限を明示し、heap 領域の扱いを見直す。  
  - サンドボックス境界とドライバアクセスの分離を強化する。デコーダでコード実行が得られてもカーネルに昇格されない設計（最小権限）を徹底する。  
  - 可能な限りログ・メトリクスで異常なデコーディング動作を検知できるようにする。
- 調査／防御の観点：
  - メディア処理は自動化されると 0クリック攻撃面が増える。プロダクト設計時に「自動処理 vs ユーザー許可」のバランスを再検討すること。

以上を踏まえ、メディア系の自動処理機能は利便性とリスクのトレードオフを伴うことを理解し、端末管理者・開発者は迅速なパッチ適用と設計改善を優先すべきです。
