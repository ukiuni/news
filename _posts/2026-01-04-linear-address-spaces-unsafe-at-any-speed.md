---
  layout: post
  title: "Linear Address Spaces: Unsafe at any speed - 線形アドレス空間：どの速度でも安全ではない"
  date: 2026-01-04T19:55:49.751Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "https://queue.acm.org/detail.cfm?id=3534854"
  source_title: "Linear Address Spaces: Unsafe at any speed"
  source_id: 46442282
  excerpt: "線形アドレス空間の限界が性能と安全を侵食、CHERIが実用的解決策を示す"
---

# Linear Address Spaces: Unsafe at any speed - 線形アドレス空間：どの速度でも安全ではない
「ポインタにシートベルトを」——線形アドレス空間の限界と、能力（capability）ベース設計がもたらす未来

## 要約
現代のCPUやOSが抱える「線形アドレス空間」モデルは、階層化したページテーブルや多種のページサイズなどで複雑化し、性能・安全性双方の障害になっている。CHERIのような能力（capability）ベースのポインタや、オブジェクト指向のアドレッシングにより根本的な改善が期待できる。

## この記事を読むべき理由
日本の組込み・クラウド・ブラウザ・インフラ系エンジニアにとって、メモリ安全性とパフォーマンスは日常課題です。ARMベースの端末やApple M1の普及、産業用途の厳格な安全要件を鑑みると、線形アドレス空間の限界を理解し、能力指向設計（例えばCHERI）を追うことは今後の競争力・安全設計に直結します。

## 詳細解説
- 問題の本質  
  もともと「線形の物理アドレス」に合わせた設計を互換性のために受け継いできた結果、現代の64ビットアドレス空間は階層的なページテーブル（多段のページディレクトリ）や複数ページサイズといった複雑さを抱えています。最悪ケースではメモリ参照のために複数回のメモリアクセスが必要になり、例外処理の連鎖（ダブルフォルト類）や性能低下を招きます。

- なぜ線形アドレスは時代遅れか  
  今日のソフトウェアは概念的に「オブジェクト」中心です。線形アドレスは過去の単純機械との互換性を守るための遺物であり、多くのRTOSやカーネルは線形空間の上にさらにオブジェクト抽象を実装します。つまり二重構造が無駄とリスクを生みます。

- 代替例：Rational R1000の発想  
  歴史的事例として、R1000は64ビットのグローバル空間を「(オブジェクト, オフセット)」というタプルで扱い、ハードウェア側でオブジェクトキャッシュ／タグ管理を行う設計を採用しました。これによりアドレス解決を1アクセスで行え、オブジェクト単位の安全性を確保しています。

- CHERIとMorello：能力（capability）ベースの再提案  
  CHERIはポインタをハード的に別種のデータ型として扱い、ポインタの生成／変更を既存の有効なポインタからの派生に限定することで、無効なポインタ作成や不正な参照を防ぎます。ARMのMorelloプロトタイプはこのアプローチをシリコンで試験しており、Microsoft Research の試算では過去の報告されたセキュリティ脆弱性の相当部分を防げた可能性が示されています（原著の試算を参照）。

- トレードオフと現実的な導入課題  
  CHERI的な設計は追加ビットや実装コストを伴います。既存エコシステムとの互換性、コンパイラ／ランタイムの対応、パフォーマンス影響の評価が必要です。一方で、言語だけに頼る「全員が型安全言語を使えばいい」という議論は現実的でなく、ハード＋ソフトでの安全強化は合理的な選択肢です。

## 実践ポイント
- 今すぐできること
  - 自分のプロジェクトで「ポインタの出所（provenance）」を意識する。未知のポインタ生成や整数→ポインタ変換をコードレビューで警戒する。  
  - 言語／コンパイラの安全機能（Rustやサンクション付きアロケータ、ASLR、堅牢なサンドボックス）を積極採用する。  
  - カーネルや低レイヤのコードでは、ページテーブルや多段翻訳の最悪ケースをテストして性能・例外ハンドリングを検証する。

- 中長期で考えること
  - CHERIやMorelloの動向を追い、試作環境での評価を行う（組込み機器やセキュリティ重視サービスでの適用可能性を検討）。  
  - オブジェクト単位のアドレッシングや能力ベース設計が有効なドメイン（産業制御、車載、金融インフラ等）でプロトタイプを作る。  
  - 社内のセキュリティ評価指針に「ハードウェア側のメモリ安全性」項目を追加する。

線形アドレス空間は歴史的理由で残っている設計遺物です。性能と安全を両立させるには、単なる言語の選択だけでなく、ハード／アーキテクチャレベルでの再設計を真剣に検討する時期に来ています。日本の現場でも、その議論と実験を始める価値は十分にあります。
