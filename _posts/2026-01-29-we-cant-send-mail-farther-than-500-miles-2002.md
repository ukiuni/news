---
layout: post
title: "We can't send mail farther than 500 miles - 500マイル以上メールが届かない"
date: 2026-01-29T04:22:22.107Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://web.mit.edu/jemorris/humor/500-miles"
source_title: "We can't send mail farther than 500 miles (2002)"
source_id: 46805665
excerpt: "OS更新でsendmail設定が壊れ、光速遅延で500マイル先へ送れなくなった"
---

# We can't send mail farther than 500 miles - 500マイル以上メールが届かない
500マイルで止まるメール送信の謎 — OSアップデートが招いた“光速バグ”の教訓

## 要約
大学のメールサーバで「500マイル以上にメールが届かない」という不可思議な障害が発生。原因はOSアップデートで配布された古いsendmailが、新しいsendmail用の設定ファイルを誤解釈し、接続タイムアウトを事実上ゼロにしていたため。光速による物理遅延が“距離の上限”を生んだ。

## この記事を読むべき理由
ソフトウェアのバージョンやベンダー提供イメージの扱いを誤ると、意外な副作用（デフォルト値の変化や設定非互換）が運用に致命的な影響を与える。クラウドやベンダー管理環境が一般的な日本の開発現場でも起こりうる教訓です。

## 詳細解説
- 何が起きたか：管理者がOSパッチを当てたら、システム付属のsendmailが古いバージョン（Sendmail 5）に差し替わった。設定ファイル（sendmail.cf）は元々Sendmail 8向けに書かれており、Sendmail 5は新しい長いオプション名を無視して多くの設定をデフォルト（ゼロなど）に戻した。
- 決定的な副作用：SMTP接続のタイムアウト値がゼロ扱いになり、実際には接続呼び出しが約3ミリ秒で打ち切られるように。スイッチング中心のキャンパスネットワークではルーティング遅延が小さく、接続時間は光速に近い物理遅延で決まるため、到達可能距離が約500–560マイルに“切り落とされ”た。
- 物理計算（簡易）：接続許容時間を $t\approx3\ \mathrm{ms}$、光速を $c\approx186.282\ \mathrm{miles/ms}$ とすると、往復でない単純距離は
$$d = c \times t \approx 186.282 \times 3 \approx 558.8\ \mathrm{miles}.$$
このため「500マイルより遠い相手は接続できない」現象が発生した。

## 日本市場との関連性
- ベンダー提供のOS/ミドルウェアやクラウドイメージ（Capsule/AMI等）をそのまま適用する運用は、日本企業でも一般的。バージョン差分で設定非互換が混入するリスクは同様に存在する。
- 国内データセンタ／リージョン間やSIerの保守で、似たような“不可視のデフォルト”が通信やサービス停止を招く可能性がある。

## 実践ポイント
- OS/ミドルウェアのパッチ後は必ずバージョンとバイナリの差異を確認する（特にsendmail/postfixなどMTA）。
- 設定ファイルのフォーマット互換をチェックし、バックアップとロールバック手順を用意する。
- 重要なパラメータ（タイムアウト等）は明示設定し、デフォルトに依存しない運用にする。
- アップデート後にエンドツーエンドで複数地域へ送受信テストを実施する（自動化テストを推奨）。
- ログと監視で接続失敗や異常なタイムアウトを速やかに検知する。

短い逸話ですが、「設定ファイルの書式とデフォルト値」に気をつけるだけで防げる教訓が詰まっています。
