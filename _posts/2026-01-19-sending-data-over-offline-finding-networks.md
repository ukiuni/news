---
layout: post
title: "Sending Data over Offline Finding Networks - オフライン検索ネットワークでデータを送る"
date: 2026-01-19T21:00:54.438Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://cc-sw.com/find-my-and-find-hub-network-research/"
source_title: "Find My and Find Hub Network Research  |  Caesar Creek Software"
source_id: 46622096
excerpt: "Findネットワークを悪用し、BLEビーコンで秘密メッセージを都市規模で送受信可能に"
---

# Sending Data over Offline Finding Networks - オフライン検索ネットワークでデータを送る
AirTagやAndroid端末の「Find」網を使って、インターネット接続なしに“メッセージ”を送れるって本当？Find My / Find Hubネットワークの裏側で起きている“オフライン通信”の実験と影響

## 要約
AppleのFind MyやGoogleのFind Hubといったクラウド連携型の「オフライン探索」ネットワークを利用して、任意データを一方通行で送信することが可能であるとする研究の要約。プロトコルの仕組み、既存ツールの再現、そしてデータ送信用に拡張した実装の鍵となるポイントを解説する。

## この記事を読むべき理由
日本ではiPhoneやAndroid端末が極めて普及しており、これらの分散型ネットワークは都市環境でほぼどこでも利用可能。セキュリティやプライバシー、IoT運用（資産管理／追跡）に関わる技術者やプロダクト担当は、ネットワークの利便性と潜在的悪用（ストーキングや隠れた通信経路）を理解しておく必要がある。

## 詳細解説
- ネットワークの基本動作  
  - 端末はペアリング時にECDSA/ECCに基づく鍵（公開鍵・共通鍵など）を生成・保管し、紛失モードでは24時間ごとにロールする「公開鍵」をBLEでブロードキャストする。  
  - 近隣の“Finder”端末は受信したビーコンを自分の位置情報と共に暗号化してサーバへアップロードし、サーバは公開鍵ハッシュをキーに位置レポートを保存する（Find Myでは最大7日保存、1リクエストで複数キー照会可能）。  
  - 受信者は自分が知る秘密情報から期待される公開鍵を復元し、サーバから対応する暗号化レポートを取得して復号する。

- 重要なセキュリティ/設計上の性質  
  - End-to-endで位置レポートは暗号化されており、Apple自体が単独でユーザの位置を復号できない構造はプライバシーに配慮している。  
  - 一方で「紛失デバイス側の認証が強くない」ため、Findersはフォーマットに合致する任意のBLEビーコンについて位置をアップロードする。ここが悪用の余地となる。  
  - Stalking（不正追跡）検知は存在するが、検出条件（一定距離・時間、ロール周期の特性など）をつくり込んでおり、ビーコンのステータスバイトや頻繁にキーを切り替える手法で回避されうる。

- 実験・ツールの再現  
  - OpenHaystack等のオープンソース実装でビーコン偽装は可能。公開されているPOC（例：SendMy）は既に「1ビット／広告」など制限の多い方法でデータ送信を示した。  
  - 本研究はそこから踏み込み、データを「秘密鍵側に埋める」方式に変更。送信するペイロードをECCの秘密鍵として扱い、対応する公開鍵をBLEで放送することで盗聴からの保護を強化した。  

- データ送信プロトコル（概略）  
  - メッセージはチャンク化して送る。各チャンクは新しい鍵ペアを使い、鍵空間の一部を総当たり（2^n 通り）で復元して該当する公開鍵のハッシュをサーバに問い合わせる方式でデータを取得する。  
  - n（1広告あたりに埋めるビット数）はサーバ検索の制限とトレードオフ。実装例では実用面から8ビットを多用し、ステータスバイトを併用すると実質16ビット相当の情報を詰められる。  
  - 同期問題（受信側がいつメッセージを送り始めたか不明）には「レイヤ化された通知チャネル（メッセージIDを示す“郵便受け”）」を用意し、受信側はまず“小さな鍵空間”を総当たりして新着メッセージIDを検出してから本体メッセージを取得する。  
  - 欠落チャンク対策としてキャッシュとメッセージ単位の再試行、必要なら冗長化（エラー訂正）を併用して頑健性を確保する。

## 実践ポイント
- 個人ユーザー向け  
  - iOS/Androidを最新に保つ：OSベンダは既知の回避手法や検出条件を改善する可能性がある。  
  - 「見知らぬAirTagが一緒に移動している」といった不審通知を有効にし、不審端末を検知したら物理的に回収またはメーカーサポートに連絡する。  
  - 街中で見慣れないBLEビーコンを検出したら近づかない・写真・受信ログを保存する（後の調査に有用）。

- 開発者／セキュリティ担当向け  
  - 自社IoTの脅威モデルに「サードパーティのオフライン探索網を経由した横断的通信／追跡」を入れる。特に資産管理系デバイスは意図しない形で第三者のインフラに依存するリスクを把握すること。  
  - テスト環境でOpenHaystack等を用い、BLEビーコンの挙動を観察。開発中のデバイスが悪用されないかを事前に評価する。  
  - もし独自トラッキングサービスを提供するなら、送信フォーマットの堅牢化（認証、鍵管理、レート制限）と、利用規約や法令順守（個人情報保護法など）の整備を行う。  
  - 検出・対策の研究を行う場合は責任ある開示を心がけ、公共の安全やプライバシー保護を優先すること。

短く言うと：Find My / Find Hubの仕組みは「分散検出＋鍵付きアップロード」で強力だが、設計上の“匿名受け入れ”があるため第三者がこれを使ってオフラインでデータを運ぶ実験が可能になっている。技術的な興味だけでなく、日本の実務者は普及度の高さを踏まえたリスク評価と対策を今のうちに進めるべきだ。
