---
  layout: post
  title: "Eurostar AI vulnerability: when a chatbot goes off the rails - EurostarのAI脆弱性：チャットボットが暴走した時"
  date: 2026-01-04T21:52:09.295Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "https://www.pentestpartners.com/security-blog/eurostar-ai-vulnerability-when-a-chatbot-goes-off-the-rails/"
  source_title: "Eurostar AI vulnerability: when a chatbot goes off the rails | Pen Test Partners"
  source_id: 46492063
  excerpt: "Eurostarのチャットボットがガードレールを突破し、履歴改ざんで機密情報やXSSが引き出される危険"
  image: "https://www.pentestpartners.com/wp-content/uploads/2025/12/Ross-Ai-eurostar-headlinev3-1024x576.png"
---

# Eurostar AI vulnerability: when a chatbot goes off the rails - EurostarのAI脆弱性：チャットボットが暴走した時
Eurostarのチャットボットが“ガードレール」をすり抜けて暴走する瞬間 — 見落としがちな古典的脆弱性がLLMの安全性を崩す

## 要約
Eurostarの公開AIチャットボットで、ガードレール回避・会話履歴改ざん・プロンプトインジェクションによる情報漏洩・HTMLインジェクション（自己XSS）など4件の脆弱性が見つかった。原因は「フロントエンドから送られる全履歴を鵜呑みにし、最新メッセージだけを署名／検証していた」設計ミスにある。

## この記事を読むべき理由
企業サイトや交通事業者がAIチャットを導入する流れは日本でも急速に進んでいる。今回の事例は、LLM導入で新しい仕組みを足したつもりでも、古いWeb/APIの失敗が致命傷になり得ることを端的に示している。プロダクト設計やセキュリティ運用に関わるエンジニア／プロダクト担当は必読。

## 詳細解説
- アーキテクチャ（要点）
  - フロントエンドがAPIにPOSTでchat_history（過去の全メッセージ）を送信。
  - サーバは「最新メッセージ」だけをガードレールで検査し、通った場合に署名を付与して返す。
  - 署名やguard_passedフラグは履歴の各メッセージに付与されるが、サーバは古いメッセージの改ざんを再検証しない。

- 具体的な脆弱性
  1. ガードレール回避（Guardrail bypass）
     - 攻撃者が最新メッセージを無害な内容に差し替えてガードを通し、そのリクエスト内で過去メッセージを改ざんして悪意あるプロンプトを注入。サーバは古い履歴を再検証しないため、モデルに悪意あるコンテキストが渡る。
  2. プロンプトインジェクションによる情報漏洩
     - 上記手法でシステムプロンプトやモデル名など、本来公開すべきでない情報をモデルから引き出せる可能性がある。
  3. HTMLインジェクション / Self‑XSS
     - ユーザ入力が適切にサニタイズされずにチャットUIに埋め込まれると、スクリプト実行（自己XSS）で応答内容を書き換えたりクッキー等にアクセスされる恐れがある。
  4. 会話ID・メッセージIDの未検証
     - UUID等のIDがクライアント側で容易に改変可能で、署名との紐付けが弱いと履歴の整合性が破られる。

- 運用面の問題
  - 脆弱性開示プロセスでのコミュニケーション不足や認証の遅れ。脆弱性対応での信頼構築も重要。

## 実践ポイント
- すべてサーバ側で検証する
  - 受信するchat_historyの全メッセージをサーバ側で再検証／再署名するか、履歴はサーバで管理してクライアントからは最小限の差分のみ受け取る。
- 署名と紐付けを厳格化する
  - メッセージID・会話ID・タイムスタンプ・署名を一意に結び付け、改ざんを検出できる設計（HMACや公開鍵署名の活用）。
- 出力に含める情報を最小化する
  - システムプロンプトや内部モデル情報をレスポンスに含めない。モデルからの応答もサーバ側で再検査・フィルタリング。
- 入力と出力のサニタイズ
  - UIに反映する際は必ずエスケープ。HTMLやscriptをそのまま注入しない。CSPの導入も有効。
- テストと検査
  - Burp等でchat_historyを改変するプロンプトインジェクションやXSSテストを自動化。脆弱性開示フローと連携して第三者の報告を受け入れやすい体制を作る。
- 運用上の注意
  - VDP（脆弱性開示プログラム）に迅速に応答し、対応の透明性を保つ。外部報告者との信頼関係は長期的リスク低減に直結する。

以上を踏まえ、LLMを組み込む際は「新しいモデル礼賛」に流されず、既存のWeb/APIセキュリティ原則（信頼しない・サーバ側で検証・出力を制限）を徹底することが最も重要です。
