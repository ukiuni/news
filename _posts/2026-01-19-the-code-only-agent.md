---
layout: post
title: "The Code-Only Agent - コードのみのエージェント"
date: 2026-01-19T03:34:33.922Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://rijnard.com/blog/the-code-only-agent"
source_title: "The Code-Only Agent • Rijnard van Tonder"
source_id: 46674416
excerpt: "実行可能なコードのみを出力して、再現性と監査性を劇的に高めるエージェント入門"
image: "https://rijnard.com/assets/og-code-only.png"
---

# The Code-Only Agent - コードのみのエージェント
「自然言語の答え」ではなく「実行できるコード」を常に出力させる――それだけでAIエージェントをもっと信頼できるものにする、という挑戦的な発想

## 要約
要点：エージェントに多様なツールを与える代わりに「execute_code」（コード実行）だけを許可すると、出力が再現可能で検査可能な「コード証拠（code witness）」になり、計算的な作業で信頼性とトレーサビリティが飛躍的に向上する。

## この記事を読むべき理由
日本の開発現場や事業部では「後から再現できる」「監査できる」成果物が重要です。曖昧なツール呼び出しの会話より、実行可能なスクリプトが残る設計は、社内レビューやQA、法令対応（ログ保存など）にも有利です。初心者でも考え方を掴めば、現場で即応用できます。

## 詳細解説
- アイデアの核：エージェントに複数ツール（ls, grep, curl 等）を与えると、挙動が散漫になり、途中で省略や幻覚が生じやすい。代わりに「出力は常に実行可能なコードのみ」と強制すると、モデルは問題解決のために必ずコードを書く。このコードを実行した結果が「答え」になる。
- code witnessの利点：コードは言語ランタイムの厳密な意味論に従うため、再現可能性が高い。トレースやテスト、レビューがしやすく、長時間のループ処理や大量ファイル解析のような計算的タスクに向く。
- 実装上の注意点：
  - ランタイム選定：Python／TypeScript／Rust など、ドメインや依存関係に応じて選ぶ。動的言語はインタラクティブ性で有利。
  - 制約と強制：プラグインやプリフックでファイルツールの呼び出しをブロックし、モデルにコードを書くことを学習させる必要がある。
  - 出力の扱い：標準出力/エラーや大きな結果は、閾値を決めてセッションに返すかJSONに書き出して経路情報だけ返す。これがコンテキスト肥大化を防ぐ。
- 上位概念との関係：AnthropicのSkillsやMCPなど自然言語ベースの再利用可能プロセスと対立するものではなく、むしろ補完する。Skillsはオーケストレーション向け、Code-Onlyは計算保証向けで、両者を組み合わせる未来が考えられる。

## 実践ポイント
- まずは小さく：Pythonをランタイムに選び、簡単なファイル検索やログ集計タスクをCode-Onlyで自動化してみる。
- 強制ルールを導入：エージェント実行環境で「bash」「ls」等のツール呼び出しを禁止し、プリフックで違反をブロックする。
- 出力ポリシーを定義：1KB未満はセッションに直接戻す、大きければJSONファイルに書くなどルール化してコンテキストを管理する。
- セキュリティとサンドボックス：任意コード実行は安全策必須。コンテナ／VMで隔離、タイムアウトとリソース制限を設定する。
- レビューとCIに組み込む：生成されたコードは人間のレビュー、静的解析、ユニットテスト、CIで検証してから運用に組み込む。
- 組織での活用例：大量ログ解析、自動テストスクリプト生成、データ前処理パイプラインのコード化など、日本のSI／プロダクト開発で即実戦投入可能。

短く言えば、計算的で再現性が必要な領域では「コードだけで動くエージェント」こそ実務的な価値が高い。まずは小さなタスクで試し、生成コードをレビュー・テストして運用に組み込むのが現場での近道です。
