---
layout: post
title: "HarfBuzz at 20! - HarfBuzz 20年"
date: 2026-02-06T08:24:14.388Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://docs.google.com/presentation/d/1o9Exz1c-Lr-dJjA8dcBn_Vl_Y37cupmFzmclMjBE_Bc/view"
source_title: "HarfBuzz at 20! - Google スライド"
source_id: 408007920
excerpt: "テキスト描画を支えるHarfBuzzの20年と、日本語表示（縦書き・異体字）改善への実務的示唆"
image: "https://lh7-us.googleusercontent.com/docs/AHkbwyJrzhtKQ6qeUwvf7WpJesFmw8JAlgqQrXyUNyU54mhjIwcv5mvgjQtZM6oGGZr1OMjKHTUXj1lxkFvOIUsqsJNyKYyX6tJTw2fDWewT0i_meJ313kk=w1200-h630-p"
---

# HarfBuzz at 20! - HarfBuzz 20年
テキスト描画の“見えない主役”が20周年 — フォントの魔法を支えるHarfBuzzの今と、これからの日本語表示への意味

## 要約
HarfBuzzは文字を「形」に変換するオープンソースのシェーピングエンジンで、20年でブラウザやOS、アプリのテキスト品質を支えてきた。複雑なスクリプトやOpenType機能の扱いに強く、今後も可変フォントやカラーフォント対応で進化を続ける。

## この記事を読むべき理由
日本のプロダクトでも正しい和文表示（縦書き、異体字、字形選択など）がユーザー体験を左右する今、HarfBuzzの仕組みと実務での使いどころを知っておくことは開発・品質改善に直結します。

## 詳細解説
- HarfBuzzの役割：テキスト（コードポイント列）をフォントのグリフ列に変換し、位置調整を行う「シェーピング」を担う。OpenTypeのGSUB/GPOS規則や複雑スクリプト（アラビア、インド系など）を正確に適用する。
- なぜ重要か：グリフの選択や位置が間違うと文字が重なったり、読むに堪えない表示になる。ブラウザ、PDF、GUIツールキット（GTK/Qt）、OSのテキストスタックが一貫した出力を得るためにHarfBuzzが用いられる。
- 技術進化：過去20年でパフォーマンス最適化、可変フォント（variable fonts）、カラーフォント（COLR/CPAL、SVG）対応、APIの安定化が進んだ。コミュニティ（Google、Red Hat、Mozilla等の貢献）が中心になりクロスプラットフォームで広く採用されている。
- 日本語との関係：日本語は欧米言語ほど複雑なシェーピングは不要でも、縦書き、縦中横、異体字セレクタ、かなの字形バリエーション、ルビ（補助的に別実装）などでフォントの機能を正しく使う必要がある。HarfBuzzはOpenType機能を通じて字形選択や位置調整を制御できるため、和文の品質向上に役立つ。

## 実践ポイント
- HarfBuzzツールでフォント挙動を確認する：harfbuzz-toolsのhb-shapeでどのグリフが選ばれるかを見ると問題発見が早い。
```bash
# Debian/Ubuntu でのツール導入
sudo apt install harfbuzz-tools

# フォントに対するシェーピング結果を確認
hb-shape /path/to/NotoSansJP-Regular.otf "日本語テキスト" --features=liga
```
- 問題切り分け：表示がおかしいときは（1）フォントに該当機能があるか（2）HarfBuzzの適用するfeature/script/directionが正しいかをチェックする。
- 言語/スクリプト/方向を指定して試す：hb-shapeのオプションで script や language を指定し、縦書きや特殊ルールの挙動を確認する（CLIやバインディングで指定可能）。
- アプリ組み込み：Linux/クロスプラットフォーム系ではライブラリを直接使うか、GTK/Qtなど既存のテキストスタック経由でHarfBuzz恩恵を受けられる。Pythonなどで試したい場合は uharfbuzz 等のバインディングを利用。
- 日本市場向けの注意点：縦書きや異体字、フォント切替時の一致性（和文フォールバック）をCIに組み込んで自動化テストすることで品質を保てる。

参考（始める場所）: HarfBuzz公式ドキュメントとharfbuzz-toolsの使い方をまず確認し、手元のフォントでhb-shape/hb-viewを動かして違いを観察することが最短の学習ルートです。
