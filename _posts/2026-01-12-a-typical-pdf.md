---
layout: post
title: "A Typical PDF - 典型的なPDF"
date: 2026-01-12T14:01:11.016Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://hackerfactor.com/blog/index.php?/archives/1085-A-Typical-PDF.html"
source_title: "A Typical PDF  - The Hacker Factor Blog"
source_id: 723981799
excerpt: "見た目は同じでもPDFに潜む編集痕を実務目線で見抜く手法を30年の観察で解説"
---

# A Typical PDF - 典型的なPDF
そのPDF、本当に「そのまま」ですか？──編集の痕跡を見抜くための現場ガイド

## 要約
PDFは見た目以上に「多様で不確定」なファイル形式で、構造の違いや生成パイプラインが多岐にわたるため、編集痕跡の判定は想像以上に難しい──元記事は30年分の観察からその理由と実務的な検査方針を解説しています。

## この記事を読むべき理由
日本でも請求書・行政書類・契約書などPDFが法的・業務的に重要な場面で使われます。見た目で「改ざんなし」と判断すると致命的なミスになる一方、単純な構造差異を改ざんと誤認するリスクもあります。実務でPDFに信頼性の判断を求められる人は必読です。

## 詳細解説
- PDFの内部は「ヘッダ（%PDF-1.x）」「オブジェクト群」「クロスリファレンス（xref/XRef）」「startxref」「%%EOF」といったパーツで成り立ちます。ビューワーはこれらを辿って描画します。
- 問題は「典型」がほとんど存在しないこと。生成ツールや配信経路（テンプレート→差し込み→再エンコード→メールゲートウェイ→デバイス最適化など）ごとに出力が変わり、同じ発行元でも異なるフォーマットのPDFが生成されることが普通です。
- よくある検出手掛かりと落とし穴：
  - 複数の %%EOF / startxref / xref：編集を示すことがあるが、段階的生成（途中で一時的に書き出す実装）が原因であることも多い。
  - 同一オブジェクトIDの再定義：編集痕の可能性があるが、実装の都合や生成ライブラリの癖でも発生する。
  - オブジェクト世代番号（generation）が非ゼロ：仕様上は世代番号で置換を示すが、実運用ではほとんどゼロ固定で、非ゼロは「珍しい＝注目」に値する。
  - 仕様バージョンの不一致（ヘッダにPDF-1.5とあるのに1.5機能は未使用など）：エンコーダの怠慢や互換性対策が原因で、これ自体が改ざんを意味するわけではない。
  - ビューワーによる自動修正：iTextなど一部生成器のバグや不正確なオフセットを、AcrobatやFirefoxなどが独自ルールで補正して表示できる場合がある。つまり“見えている通り”でないことがある。
- 結論として、単一のルール（複数EOF＝改ざん）で確定できない。検査は多面的・比対的に行う必要がある。

## 実践ポイント
- 最初にやること
  - 元の発行元（システム）が出す「通常のPDF」を複数収集して比較する。ただし同一フォーマットが得られないケースもある点に注意。
  - 可能なら元のネイティブファイル（Word、CSV、XMLなど）を入手する。差し込みや再生成で変わることが多い。
- 自動解析ツールを併用する
  - pdfinfo（poppler）、qpdf、pdfid、pdf-parser（Didier Stevens）などで構造（オブジェクト数、xref、EOF位置）を確認する。
  - 例（端末での最初の確認）:
    ```bash
    # bash
    pdfinfo target.pdf
    qpdf --show-encryption target.pdf
    ```
- 見つけた指標の使い方
  - 複数EOFやstartxrefが見つかっても「即改ざん」と結論づけない。どのオフセットが実表示に使われているか、どのオブジェクトが描画経路に含まれるかを確認する。
  - 同一オブジェクトIDの重複や非ゼロ世代番号は注目ポイント。発見時は生成ライブラリやワークフローの調査を行う。
  - メタデータ（Producer, Creator, CreationDate, ModDate）も参考になるが容易に改竄されるため単独証拠にはしない。
- 手続き面の対策
  - 重要書類はハッシュとタイムスタンプ、チェーンオブカストディを確保して保存する。
  - 法的・コンプライアンス用途ならPDF署名（デジタル署名）や公的な認証済みPDFワークフローを導入する。
- 最後に心得
  - PDF解析は「痕跡の蓄積と文脈」の仕事。自動診断は有用だが、最終判断は生成元、配信経路、ビューワー挙動まで含めた調査と突き合わせること。

（元記事「A Typical PDF」より要旨を日本語で再構成）
