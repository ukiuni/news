---
layout: post
title: "Cosmologically Unique IDs - 宇宙規模で唯一のID"
date: 2026-02-18T19:12:57.930Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://jasonfantl.com/posts/Universal-Unique-IDs/"
source_title: "Cosmologically Unique IDs | Jason Fantl"
source_id: 47064490
excerpt: "宇宙規模で衝突しない識別子の設計原則と実運用での妥協点を提示"
image: "https://jasonfantl.com/https:/bloag-assets.netlify.app/gifs/CUIDs/cover.png"
---

# Cosmologically Unique IDs - 宇宙規模で唯一のID
「銀河をまたいでも衝突しないID」を本気で考えてみたくなる話

## 要約
ランダムID（UUID等）は確率的に衝突をほぼゼロにできるが、宇宙全体や極端なユースケースを想定すると必要なビット長は桁違いに大きくなる。代替として中央カウンタや階層化（Dewey）、2進木やトークン方式など、可用性と長さのトレードオフがある。

## この記事を読むべき理由
IoT、衛星コンステレーション、サプライチェーンの追跡、宇宙ビジネスなど、日本でもID一意性は実務問題。将来の分散・断絶環境を見据えた選択肢と実務的な妥協点がわかります。

## 詳細解説
- ランダムID（確率的）
  - UUIDv4等は約122ビットのランダム性を持ち、衝突確率は実用的にはゼロにできる。衝突期待数は誕生日のパラドックスで評価。
  - 衝突確率近似:
  $$
  p(n,d)\approx 1 - e^{-\frac{n(n-1)}{2d}}
  $$
  - 仮に宇宙全体が最適な計算機で $n=10^{120}$ 個のIDを生成すると期待衝突を避けるためには $d\approx 10^{240}$（約798ビット）が必要という計算になる（極端な上限）。
  - 実務的な比較：原子レベルだと約532ビット、1gナノボット全体想定で約372ビット、UUIDは122ビット。

- 確率的生成の注意点
  - 真のランダムネス（量子乱数源やCSPRNGの適切なシード）が重要。擬似乱数でよく使われる初期値や「ありふれた」IDは排除すべき。

- 決定論的（理論的に重複ゼロ）
  - 中央カウンタ：完全に一意だが中央への到達性／遅延問題がある（遠隔惑星では使えない）。
  - 階層化（Dewey）：親が子にカウンタを割り当てる形式（例：13.5.3）。ローカルでID発行可能で可用性は高いが、木構造の形によってID長が変化（チェーンだと線形、良い分岐だと対数的）。
  - Binary / 2-adic等：木構造や数論的手法で一意性を保つ設計。最悪ケース・最良ケースで成長特性が異なる。
  - Token方式：トークン＋ホップ数を使い、チェーンでも対数的成長を目指す。ID中にトークン履歴が増えるため全体の長さは若干増す。

- トレードオフ総括
  - 可用性（いつでもどこでもIDを発行できる） ⇄ グローバル一意性を保証するための同期や空間的分配（中央、衛星、階層）。
  - ビット長（保存・伝送コスト） ⇄ 衝突確率と将来スケールへの耐性。

## 実践ポイント
- 今すぐの実装（IoT/社内システム）：UUIDv4等の122ビットランダムIDで十分。CSPRNGを使い、既知の弱い初期値を避ける。
- 断絶／分散環境（離島・宇宙・極端なオフライン）：
  - Dewey的な階層命名（親子カウンタ）やトークン方式を検討。ローカル発行を前提にした名前空間設計が重要。
  - ノードID（固有の機器識別子）＋ローカルカウンタの組合せで単純に運用可能。
- 超長期・超大規模を想定するなら：ビット長増加のコストとベネフィットを見積もる（例：安全域として256/512ビットを使うか）。
- 運用上の注意：衝突検知・再発行フロー、禁止IDリスト（all-zero等）、監査ログを必ず設計する。

以上を踏まえ、用途と運用条件（オフライン頻度、将来のスケール、保存コスト）を軸に「確率的短め（UUID）」と「決定論的だが設計が複雑（階層・トークン）」のどちらを採るか判断してください。
