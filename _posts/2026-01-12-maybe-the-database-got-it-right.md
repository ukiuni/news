---
layout: post
title: "Maybe the database got it right - データベースが正しかったのかもしれない"
date: 2026-01-12T01:10:36.777Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://fhur.me/posts/2026/maybe-the-database-got-it-right"
source_title: "Maybe the database got it right"
source_id: 429099817
excerpt: "DBの高度機能を再評価し、重い問い合わせをDBで解決して開発と性能を劇的に改善しよう"
image: "/preview.png"
---

# Maybe the database got it right - データベースが正しかったのかもしれない
今こそ見直すべき「データベース軽視」の習慣 — APIやORMで同じものを何度も作り直していませんか？

## 要約
長年の慣習でデータベースは「下層の実装」に追いやられてきたが、現代のアプリは再びデータベースの問いに答える力を必要としており、我々はしばしばその機能をアプリ側で作り直している可能性がある、という警鐘。

## この記事を読むべき理由
日本のプロダクトでも、SPAや多様なAPI連携、レガシーDBとの共存などによりデータの問い合わせが複雑化しています。無自覚にDBの能力を使わない選択を続けると、開発効率や性能、運用コストで不利になります。特に金融やECなどデータ整合性が重要な領域では要注意です。

## 詳細解説
- 歴史的背景：1990年代以降のオブジェクト指向、ドメイン駆動設計（DDD）、ORMの普及で「データはオブジェクトで考える」流れが強まり、RDBは「実装の詳細」へと格下げされた。
- アーキテクチャの変化：REST→SOA→マイクロサービス、さらにNoSQLの登場で「共有DBは悪」という思想が強まったが、実際の業務アプリは依然として関係性の深いデータ（CRUD、結合、集計）を扱うことが多い。
- フロントエンドの成熟：SPAやReactによりクライアント側で複雑な集約や結合を再実装するケースが増え、過剰なAPI呼び出し（ウォーターフォール）やクライアント側でのジョインが発生。
- GraphQLの登場：クライアントに「欲しい形で問う」能力を与えたが、同時にスキーマ、クエリ計画、認可、パフォーマンスチューニングなどデータ層で既に扱われている課題をサーバ側で再発明することになった。
- データベースの進化：近年のRDBはJSON対応、ウィンドウ関数、CTE、行レベルセキュリティ、論理レプリケーションなどを取り込み、複雑な問い合わせやセキュリティ要件に応えられるようになっている。
- 問題の本質：我々はしばしば「思想」に合わせてツールを遠ざけ、その結果として本来DBが得意とする処理を別の場所で非効率に再構築している。DBを「否定する」ではなく「いつ活かすか」を見直すべき段階に来ている。

## 実践ポイント
1. アクセスパターンを可視化する：どのクエリが多く、どの集約が重いかをまず計測する。無駄なAPIラウンドトリップを洗い出す。  
2. SQLとDB機能に投資する：CTE、ウィンドウ関数、JSONB、インデックス、行レベルセキュリティを学び、適材適所で使う。  
3. 業務ロジックの配置を評価する：トランザクション性・整合性が重要な部分はDB側（ストアドプロシージャ／関数）に残す検討を。  
4. 型安全と契約を守る：スキーマ駆動（DDL＋型定義）とクライアントの型生成で整合性を高める。SynthQLや型安全クライアントのようなアプローチを参考に。  
5. 小さく試す：既存の設計を一気に変えず、特定の重い問い合わせをDBに移すA/Bやベンチで効果を確認する。  
6. 運用面も忘れずに：読取りレプリカ、キャッシュ、監視（クエリプラン、遅延）を組み合わせて安定性を確保する。

短期的な流行やアーキテクチャ思想に流されず、「どこが最も効率よく答えを返せるか」を基準に設計を見直すと、意外に生産性と性能の両方が改善します。
