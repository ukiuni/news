---
layout: post
title: "Drone Hacking Part 1: Dumping Firmware and Bruteforcing ECC - ドローンハッキング パート1：ファームウェア吸い出しとECC解析"
date: 2026-01-17T06:42:05.265Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://neodyme.io/en/blog/drone_hacking_part_1/"
source_title: "Drone Hacking Part 1: Dumping Firmware and Bruteforcing ECC — Neodyme"
source_id: 46654749
excerpt: "**基板からのNAND吸出しで露見したOOB/ECCの落とし穴と解析手法**"
image: "https://neodyme.io/_astro/drone_hacking_part_1.Ba79Ryqz.jpg"
---

# Drone Hacking Part 1: Dumping Firmware and Bruteforcing ECC - ドローンハッキング パート1：ファームウェア吸い出しとECC解析
魅力的タイトル：見えない心臓部を覗く — 市販ドローンのファームウェア吸い出しで見えた「微小ビット誤り」とECCの落とし穴

## 要約
市販の小型ドローン（Potensic Atom 2）を分解してNANDフラッシュを吸い出したところ、読み取り時のビット誤りや「アウト・オブ・バンド（OOB）領域／ECCレイアウト」の扱いで想定外の壁にぶつかった、という調査報告です。

## この記事を読むべき理由
- ドローンやIoT機器の中身（ファームウェア）に関心がある開発者・研究者が、実際に直面する技術的課題を知れる。
- ファームウェアの入手経路や保護（暗号化・署名・ECC）がどのように攻撃や解析に影響するかを理解し、防御の観点で役立つ。
- 日本国内のメーカー／プロダクト設計者、セキュリティ担当者にとって、実務的なリスクと対策の示唆が得られる。

## 詳細解説
- 対象と目的  
  調査対象はカメラ付き消費者ドローン（Potensic Atom 2）。目的は基板からフラッシュを取り出し、内部ソフトを逆解析して脆弱性を探すこと。

- ファームウェア入手の選択肢  
  1) メーカー配布の更新ファイルを取得する（多くは認証や暗号でガード）  
  2) デバッグポート（JTAG/UART）経由で中身を読む（多くは非搭載・未公開）  
  3) NANDチップを基板から外して物理的に吸い出す（今回の手法）  
  各手法は法的・技術的リスクがあり、現場では最短解ではなく状況依存。

- チップ同定と吸い出しの概要  
  基板上のSoC、RAM、NANDなどをマーキングやデータシートから推定。対象NANDはSPIベースのパッケージで、総容量やページ構造（例：4096バイト＋OOB領域）を確認した上で読み取りを行った。

- 読み取りで出た主な問題点
  1) 伝送・読み取り時のランダムなビット反転（bit flips）。外部リーダや簡易配線だと読み取りエラーが混入する。  
  2) 単純に生データを連結して解析してもUBI/UBIFS等のファイルシステムが壊れて見える。これはOOB（アウト・オブ・バンド）領域のレイアウトやチップ内ECCの扱いを誤認しているため。  
  3) NAND自体が保存時にビット誤りを含む可能性があるため、読み取り回数を増やして多数決で誤りを潰すなどの対策が必要となるが、それでもOOB/ECCの扱いを正しく復元しないと完全なイメージ復元は難しい。

- ECCとOOBの重要性  
  NANDは物理的に不完全な媒体なので、ユーザーデータとは別にECCやメタデータを格納する追加領域（OOB）を設けるのが一般的。解析者がページサイズを「ユーザーデータ4096バイト＋単純に256バイトのECC」と仮定すると、実際の配置とずれて文字列が切れたり、ファイルシステムが壊れて見える。正しいOOBレイアウトを理解・再構築することが不可欠。

- 利用したツールと結果の傾向（高レベル）  
  binwalkやubi_readerなど既存ツールで解析を試みたが、読み取りエラーとOOBレイアウトの不一致で失敗する場面が多かった。読み取り環境（ソケットや接続速度）やチップ固有のECC設定が解析難度を上げる。

## 実践ポイント
- 倫理・法的注意：所有機器に限定し、許可なく他人の機器を解析・改変しないこと。研究目的でも関係者の許可と適切な手順を踏む。  
- 防御側（製品開発者）への示唆：  
  - ファームウェア配布は署名＋認証を必須にする（改ざん防止）。  
  - ストレージ暗号化やセキュアブートを導入して、物理的に吸い出されても改ざん・解析の難易度を上げる。  
  - OOB/ECCの使い方やメタデータ構造を設計段階で想定し、単純なコピーだけでファームが動作しないようにする（ただし合法性とユーザビリティのバランスを考慮）。  
- 解析／研究者向けの高レベルな指針：  
  - まずはメーカー提供の更新機構やアプリ通信を探索して、ソフト的な取得ルートを検討する。  
  - 物理吸い出しは最終手段であり、ハードウェアの破損リスクや法的リスクがあることを理解する。  
  - 読み取りエラー対策として複数回取得して統計的に誤りを潰す手法や、OOBレイアウトの情報を集めることが重要（実運用的な手順の詳細説明はここでは割愛）。

この記事で扱ったポイントは、ドローンに限らずIoT機器の安全設計やリスク評価に直結します。特に日本の市場ではプライバシーや飛行安全の観点から、ファームウェア保護と更新フローの堅牢化がますます重要になります。
