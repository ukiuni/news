---
layout: post
title: "My smart sleep mask broadcasts users' brainwaves to an open MQTT broker - スマート睡眠マスクが脳波を公開MQTTブローカーへ垂れ流していた話"
date: 2026-02-14T16:04:11.319Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://aimilios.bearblog.dev/reverse-engineering-sleep-mask/"
source_title: "My smart sleep mask broadcasts users&#x27; brainwaves to an open MQTT broker | aimilios"
source_id: 47015294
excerpt: "解析で判明：スマート睡眠マスクが脳波を公開MQTTで流し、遠隔EMS制御も可能"
image: "https://bear-images.sfo2.cdn.digitaloceanspaces.com/herman-1683556668-0.png"
---

# My smart sleep mask broadcasts users' brainwaves to an open MQTT broker - スマート睡眠マスクが脳波を公開MQTTブローカーへ垂れ流していた話
睡眠用スマートマスクのリバースエンジニアリングで、実際のユーザーの脳波が公開され、しかも遠隔で電気刺激（EMS）を与えられる可能性が明らかになった衝撃のレポート。

## 要約
Kickstarter由来のスマート睡眠マスクを解析した結果、アプリに埋め込まれた共有MQTT認証情報でメーカーのブローカーに接続でき、世界中のデバイスの生体データ（EEG含む）とEMS制御が見えた／操作可能であることが判明した。

## この記事を読むべき理由
個人の生体データと身体刺激を扱うIoT機器が流通する現在、日本の開発者・ユーザーにとってプライバシー・安全性の欠如が現実的な脅威であることを示す生々しいケーススタディだから。

## 詳細解説
- ハードウェアと機能: マスクはEEG（脳波）、呼吸、加速度・ジャイロ、振動、加温、音声、眼周りの電気刺激（EMS）を備える高機能デバイス。データは高レート（EEG 250Hzなど）で収集される。
- 接続層: BLE（Bluetooth Low Energy）でコマンド送受信とデータストリームのチャネルを持つ。これ自体は一般的な構成。
- アプリ解析: Android APKを逆コンパイルした結果、Flutterで作られておりバイナリ内に多数の文字列が残存。そこから
  - ブローカーのハードコードされた認証情報、
  - クラウドAPIエンドポイント、
  - コマンド構築関数名やプロトコルの構造情報
 などが判明した。
- プロトコル復元: 解析を進めプロトコル形状と各コマンドの機能（振動、加温、EMS、音声など）を把握。最終的にMQTTブローカーに接続すると、複数デバイスの生データ（実際の脳波波形を含む）と、EMS等を制御するコマンドが配信されているのを受信できた。
- リスクの本質: ハードコードされた共有認証情報と公開／アクセス制御の甘いブローカーが原因。これにより「誰かの脳波を見る」だけでなく「遠隔で電気刺激を与える」までが技術的に可能になる。

## 実践ポイント
- 開発者向け
  - ハードコード認証は厳禁。デバイスごとの固有鍵・証明書を使用する。
  - MQTT等はTLS＋認証＋最小権限のACLを必須にする。公開ブローカーは避ける。
  - 生体データは必要最小限で送信・保存し、暗号化とアクセスログを実装する。
  - EMS等の行為を伴う機能はユーザー同意・明示的な安全ガード（最大出力／時間制限・物理キャンセル）を設ける。
  - バイナリに機密情報を残さない。ソフトでの秘密管理は専用システムへ。
- ユーザー向け
  - ファームウェアとアプリは常に最新へ。公開報告が出た製品は利用を見直す。
  - IoT機器は別ネットワーク（ゲストVLAN）へ分離する。機密性の高いデータを扱う機器は慎重に。
  - ベンダーのセキュリティ対応（脆弱性報告窓口、パッチ提供）を確認する。
- 事業者／管理者向け
  - 早急に認証情報のローテーションとブローカーのアクセス制御を実施し、影響範囲を調査する。
  - ユーザーへの通知と是正策、外部CERTへの報告を検討する。
  - 医療的用途に近い機能は法規制（医療機器認証など）との整合性を確認。

この事例は「便利な睡眠ガジェット」が個人の最もセンシティブなデータと身体的安全に直結することを示しています。日本の開発者・ユーザーとも無関係ではありません—プロダクト設計と運用の見直しを強く推奨します。
