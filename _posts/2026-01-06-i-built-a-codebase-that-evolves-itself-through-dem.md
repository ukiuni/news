---
  layout: post
  title: "I built a codebase that evolves itself through democracy - 私は「民主」で進化するコードベースを作った"
  date: 2026-01-06T13:37:58.502Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "http://openchaos.dev"
  source_title: "OpenChaos.dev"
  source_id: 469776301
  excerpt: "プルリクを投票で自動マージし、CI連携と安全対策で民主的に進化するコード基盤"
  ---

# I built a codebase that evolves itself through democracy - 私は「民主」で進化するコードベースを作った
コードが“投票”で進化する──OpenChaos.devが提示する、開発の民主化とその現実的な課題

## 要約
OpenChaos.devはプルリクエストを“提案”として扱い、コミュニティの投票でマージを決める仕組みを提供する実験的プラットフォーム。GitHub APIを使った自動化と投票ベースのガバナンスでコードベースが自律的に変化する。

## この記事を読むべき理由
日本のオープンソース／社内OSSカルチャーでも、より多様な貢献者を受け入れつつ品質を保つ仕組みは求められています。OpenChaosのアプローチは、分散ガバナンス、CI連携、自動マージの設計上のトレードオフ（利便性 vs. 安全）を学ぶ良いケーススタディです。

## 詳細解説
- 基本の仕組み  
  - プルリクエストを「提案（proposal）」と見なし、一定期間カウントダウンして投票（UIのクリック、GitHub reactions など）を集める。  
  - 投票の閾値に到達すると自動でマージ操作を試みる。OpenChaos.devのUIには「--d --h --m --s until next merge」といった次回マージまでのカウントダウンや、"Vote to merge" 表示があり、GitHub API経由でマージを実行／制御していることがうかがえる。  
  - 実行はGitHub APIのレート制限と整合する設計が必要（エラーハンドリング、リトライ、キャッシュ）。

- 技術的ポイントと注意点  
  - 認証と権限: マージを実行するBotアカウントは必要最小限の権限に限定する。トークン漏洩対策や短命トークンが重要。  
  - CIゲーティング: 自動マージ前にGitHub Actionsや外部CIでテストを必須にしておく。マージは「投票閾値を満たす AND CIがパス」の論理にする。  
  - 悪意あるPR対策: 自動マージはサプライチェーン攻撃の入口になり得る。依存更新やビルドスクリプト変更の扱いは厳格に（手動レビューや別ルール）。  
  - 投票の公平性: Sybil攻撃やボット投票を防ぐため、投票者の信頼度（contribution historyやGitHubアカウントの条件）を用いる設計が有効。  
  - レート制限設計: GitHub APIのrate limitに対しては、イベント駆動（webhook）＋ローカル集計＋バッチ処理で呼び出しを平滑化する。エクスポネンシャルバックオフとリトライ戦略を組み込む。  
  - コンフリクトとリバート: 自動マージ後に問題が出た場合の迅速なロールバック手順、監査ログ、CIのカナリア（段階的ロールアウト）を用意する。

- 実装コンポーネント（概観）  
  - フロントエンド：PR一覧、投票UI、カウントダウン表示  
  - 集計サービス：webhookでイベントを受け取り投票を集計、閾値判定  
  - マージ実行サービス：トークンでマージ命令を出す、CI合格条件を確認  
  - モニタリング：マージ頻度、CI成功率、リバート率、セキュリティアラート

## 実践ポイント
- 小さく試す：まずは個人またはチームの非プロダクト試験リポジトリで運用する。自動マージはデフォルトで「ドライラン」モードに。  
- 投票ルールを明文化：誰が投票できるか、必要閾値（例：5票かつ投票者のうち一定割合はコア貢献者）を決める。  
- CIを厳しくする：テスト、静的解析、依存チェッカーを必須ゲートにする。依存更新は別ルールで扱う。  
- レート制限対策：webhookベースでイベントを受け、ローカルで集計したタイミングでAPIを叩く。API呼び出しはバッチ化してバックオフを実装する。  
- セキュリティ対策：Botトークンを少権限に、監査ログと自動アラート（異常なマージ頻度や大きなファイル変更）を設定する。  
- KPIを測る：マージ成功率、リバート率、平均マージ所要時間、セキュリティインシデント件数を定期的に評価する。

OpenChaos.devのアイデアは「民主的に進化するコードベース」という刺激的な実験です。日本の現場で採用するにはガバナンスとセキュリティの設計が鍵になりますが、小さな実験から始めれば学びは大きく、開発の参加モデルを拡張する有力な手法になり得ます。
