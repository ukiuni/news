---
layout: post
title: "I found a Vulnerability. They found a Lawyer - 漏洞を見つけたら、相手は弁護士を連れてきた"
date: 2026-02-20T20:31:27.977Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://dixken.de/blog/i-found-a-vulnerability-they-found-a-lawyer"
source_title: "I found a Vulnerability. They found a Lawyer. | Blog | Yannick Dixken"
source_id: 47092578
excerpt: "連番識別子と共通初期パスで個人情報が丸見え、報告で弁護士が介入、被害通知は不明"
image: "https://dixken.de/images/blog/costa-rica.jpg"
---

# I found a Vulnerability. They found a Lawyer - 漏洞を見つけたら、相手は弁護士を連れてきた
「連番ID＋共通初期パスワード」で個人情報が丸見えに――責任ある開示が法的圧力に遭った実話

## 要約
ダイビング保険の会員ポータルで、連番のユーザーIDと共通の初期パスワードだけでアカウントに入れてしまう致命的な認証欠陥が発見された。調査者は責任ある開示を行ったが、組織は法務対応で反応し、利用者への通知が行われたかは不明のままだ。

## この記事を読むべき理由
同様の単純ミスはどんなウェブサービスにも起こり得ます。日本でも旅行・保険・教育など個人情報を扱うサービスは多く、仕組みの理解と今すぐできる対策は即実務的価値があります。

## 詳細解説
- 発見状況：インストラクターが生徒のためにアカウントを作成すると、システムは連続する数値のユーザーIDを割り当て、共通の初期パスワードを設定していた。初回ログインでの強制パスワード変更も無い。
- 問題点：ID列挙（IDを順に推測）＋全アカウント共通の初期パスワードで多くのアカウントへ容易にアクセス可能。レート制限、アカウントロック、MFA等の防御が無く、未成年の情報も含めたフルプロフィールが取得できた。
- 検証方法：確認は最小限のアクセスで行われ、動作確認にはブラウザ自動化（Selenium等）でログインを自動試行して範囲を把握した（データは削除済み）。
- 開示と反応：報告はCSIRTを含めて30日ルールで行われたが、組織側は法務（弁護士）経由で機密保持の署名を求め、法的な抑止を示唆。脆弱性自体は修正され、初期パスワードのリセットや2FA導入が進められたが、被害者通知が適切に行われたかは未確認。欧州ではGDPRに基づく通知義務が問題となる場面。

簡易イメージ（説明用の擬似コード）:
```python
# python - 擬似コード（実行不可）
DEFAULT_PASSWORD = "initial123"
for uid in range(start_id, end_id):
    if try_login(user_id=uid, password=DEFAULT_PASSWORD):
        profile = fetch_profile(uid)
        save(profile)
```

## 実践ポイント
- 登録/認証設計の基本を守る：連番IDをそのまま識別子に使わない（ランダムな識別子/UUIDを採用）。
- 初期パスワード運用を廃止：初回ログインで強制パスワード変更、もしくは招待リンク＋ワンタイム設定を採用。
- 防御策を重層化：レート制限、アカウントロック、ログ監視、MFAを必須化。
- テスト項目に「ID列挙」チェックを追加：連番や推測可能な識別子で情報取得が可能か自動で検出する。
- インシデント対応と透明性：脆弱性報告には迅速に応答し、影響があれば利用者通知と所管当局への届出を検討する（日本では個人情報保護法、関係ガイドラインに従う）。
- 開発者向け実務：公開環境での初期アカウント作成フローを見直し、コードレビューや脆弱性スキャンの定期実施を習慣化する。

短く言えば「単純な設計ミスが大きな個人情報漏えいにつながる」――今日からID設計と初期認証フローを点検してください。
