---
layout: post
title: "Rendering the visible spectrum - 可視スペクトルを描く"
date: 2026-02-14T05:38:34.531Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://brandonli.net/spectra/doc/"
source_title: "Rendering the Visible Spectrum"
source_id: 442208188
excerpt: "物理に基づくスペクトル再現法で自然かつ正確な虹描画が学べる、実装例で即活用"
---

# Rendering the visible spectrum - 可視スペクトルを描く
虹を「本物っぽく」描くための物理と色変換の教科書

## 要約
コンピュータ上で「自然に見える」可視スペクトル（虹色）を再現するには、単に波長→RGBの単純変換では不十分で、光のスペクトル分布、視覚の三原色性（Grassmannの法則）、CIEの色匹配関数、色空間・ガンマ・ガマット制約を順に考慮する必要がある、という話です。

## この記事を読むべき理由
Webやプレゼン、データ可視化、UIデザインで「虹ラベル」や分光表示を使う場面は多く、日本のプロダクトでも色の誤表現が信頼性やユーザ体験に影響します。物理的に正しい（かつ見栄えの良い）スペクトル画像の作り方を知ることで、色表現の精度が格段に上がります。

## 詳細解説
- 色は光のスペクトル分布 $S(\lambda)$ に依存します。ここで $S(\lambda)\,d\lambda$ は波長$\lambda$〜$\lambda+d\lambda$のエネルギー量を表します。  
- 視覚は三次元的に記述可能で、Grassmannの法則により任意のスペクトルは「見かけ上」3つの値で表せます（＝色空間の次元が3）。これが色をXYZやRGBに落とせる根拠です。
- 実務的な変換はCIEの色匹配関数 $\bar{x}(\lambda),\bar{y}(\lambda),\bar{z}(\lambda)$ を用いてスペクトルからXYZへ積分することで行います：  
  $$X=\int S(\lambda)\,\bar{x}(\lambda)\,d\lambda,\quad Y=\int S(\lambda)\,\bar{y}(\lambda)\,d\lambda,\quad Z=\int S(\lambda)\,\bar{z}(\lambda)\,d\lambda.$$
- 次にXYZを（色空間行列で）線形sRGBなどのRGB系に変換し、線形→非線形（ガンマ）変換を適用します。その際、ディスプレイの参照白（例えばD65）や色域（sRGB/Display P3/BT.2020）に合わせた色度調整・クリッピングが必要です。
- 注意点：メタメリズム（異なるスペクトルが同じ色に見える現象）、有限のモニタガンマットにより実際のスペクトル全域を完全に再現できないこと、強度（輝度）情報が色の印象に大きく影響すること。さらに背景光や周囲色で見え方が変わります。
- 見た目を「科学的にかつ自然に」するには、波長ごとの相対輝度（例えば太陽光や白色光源のSPD）を掛けてやる、色を滑らかにするために十分に細かい波長ステップでサンプリングする、などの工程が必要です。

## 実践ポイント
- 波長範囲は一般に380–780 nmを扱う。サンプリングは1–5 nm刻みで十分（精度と処理時間のトレードオフ）。
- 変換手順：スペクトル $S(\lambda)$ → CIE XYZ（積分）→ 線形RGB（行列）→ ガンマ（sRGBなど）→ ガンマット外はクリップまたはトーンマップ。
- 参照：CIE 1931色匹配関数と参照白（D65）を使う。日本の一般的表示環境はsRGB/D65が多いが、スマホやハイエンドディスプレイはDisplay P3対応なので意識する。
- デザイン上のコツ：背景は中間灰（例：50%グレー）を使うとスペクトルの色差が歪みにくい。可視帯の輝度差を加味して描画（黄色は相対的に明るく出る）すると自然に見える。
- 実装例（概念）：波長ループ→XYZ積分→行列変換→ガンマ→画像ピクセル。既存のライブラリ（色変換やCIEデータ）を活用するのが現実的。

以上を踏まえれば、ネットでよく見る「帯状に段差のある偽スペクトル」から脱却し、物理的根拠に基づいた美しい虹表現が作れます。日本のUIや教育資料、科学可視化にすぐ使える知見です。
