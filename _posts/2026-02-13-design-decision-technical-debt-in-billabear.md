---
layout: post
title: "Design Decision: Technical Debt in BillaBear - BillaBearに残る技術的負債の設計判断"
date: 2026-02-13T12:39:20.733Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://iain.rocks/blog/technical-debt-in-billabear"
source_title: "Design Decision: Technical Debt in BillaBear | Iain Cambridge"
source_id: 442769841
excerpt: "BillaBear事例で学ぶ、影響×コストで決める技術的負債改善ガイド"
---

# Design Decision: Technical Debt in BillaBear - BillaBearに残る技術的負債の設計判断
驚くほどリアルな「スタートアップの負債白書」──あなたのチームにも当てはまる設計ミスとリファクタ優先度

## 要約
BillaBearの開発で蓄積された「技術的負債」を整理し、どこを先に直すべきかを説明した記録。レガシーな実装、フレームワークの進化に伴う置き換え点、検索基盤のミスマッチ、テスト不足、フロントエンドの手戻りなどが中心。

## この記事を読むべき理由
日本のスタートアップや中小開発チームでも同様の負債は頻出。限られた時間と予算で「どこを我慢して、どこを今直すか」を判断するための実務的ヒントが得られます。

## 詳細解説
- 古い慣習と互換性対応: PHP 7.x時代の書き方（クラス内プロパティ定義）をそのまま残している箇所が多く、PHPのコンストラクタプロモーションやreadonly導入で設計を刷新できる。可読性・不変性の向上が期待できる。  
- DTOの進化: プロパティをクラス本体で定義する旧スタイルから、コンストラクタプロモーション＋readonlyへ移行中。コピー＆ペーストで生まれた冗長さを削減する狙い。  
- Enumやネームスペースのズレ: Enumをまとめるために単一のnamespaceに置いたが、DDD（ドメイン駆動設計）的な命名・配置と齟齬があり再配置を検討中。命名は後工程での手戻りコストを大きくする。  
- フレームワーク機能との差分: かつて自作したバッチ処理やDataMapperは、Symfonyの新機能（Scheduler、ObjectMapper/属性ベースのマッピング）で置き換え可能。フレームワーク標準を採ることで保守負担を下げられる。  
- シリアライゼーションとエラーハンドリング: コントローラ前でDTOを決めてシリアライズする流れが導入されたが、エラー時の診断ログ（どのコントローラ/メソッドか特定する）が取りにくくなる懸念があるため、ログ設計をどう保つかが課題。  
- 検索基盤の選定ミス: Elasticsearchを導入したが、UUID検索と単純なIDベースのフェッチには過剰。RDBや専用のUUID対応インデックスの方が適切なケースが多い。用途に応じたツール選定が重要。  
- テストの偏り: BillaBearは機能テスト（Behat等）に注力し、ユニットテストは少なめ。AIを使ったユニットテスト生成は初期改善として有望で、既存コードのテスト網羅を増やす近道になり得る。  
- フロントエンドの技術負債: バックエンド畑の開発者が作ったためフロントは散らかっている。コンポーネント化や状態管理の整備が必要で、外部のリカバリチーム検討も合理的。

## 実践ポイント
- 優先順位は「影響範囲×修正コスト」で決める。ユーザ影響が大きくコスト低のものから着手。  
- フレームワークの公式機能は積極採用（Scheduler/ObjectMapper等）して保守コストを削減する。  
- 検索要件は要件ベースで選定する。単純なID検索はRDBのインデックスで十分なことが多い。  
- シリアライズ前後のエラーロギング設計を明確化し、診断ポイントをロギングに残す。  
- ユニットテストはAI補助で初期網羅を作り、レビューで品質を上げるワークフローを採用。  
- フロントはコンポーネント分割や状態管理の指針を作り、必要なら専門家に回復を依頼。

（出典: Iain Cambridge, "Design Decision: Technical Debt in BillaBear" を要約・再構成）
