---
layout: post
title: "Cutting Up Curved Things (With Math) - 曲面を三角形で切り分ける（数学で解く）"
date: 2026-01-30T00:50:01.781Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://campedersen.com/tessellation"
source_title: "Cutting Up Curved Things - Cam Pedersen"
source_id: 46817764
excerpt: "曲面を三角形サンプリングで高品質に効率変換、極や穴処理も解説"
image: "https://campedersen.com/og/tessellation"
---

# Cutting Up Curved Things (With Math) - 曲面を三角形で切り分ける（数学で解く）
魅せる曲面はGPUの「三角形」でできている — その仕組みと実務で使えるコツ

## 要約
GPUは曲面を理解しない。全ては三角形メッシュに落とし込まれるため、滑らかな曲面をどう「サンプリング」して三角形に変換するかが鍵になる。

## この記事を読むべき理由
CAD、3Dプリント、ゲーム、Webビジュアライゼーションなど日本の現場で当たり前に使うツールの裏側が分かると、品質調整やデバッグ、パフォーマンス改善に直結する知識が得られる。

## 詳細解説
- 基本データ構造  
  GPUが扱うのは2つの配列だけ：頂点配列とインデックス配列。頂点は3次元座標の列で、例：$[x_0,y_0,z_0,x_1,y_1,z_1,\dots]$。インデックスは3つずつで三角形を定義する。

- パラメトリック曲面の翻訳問題  
  CADカーネル内では円柱や球は関数で表現される（例：円柱点は角度$u$と高さ$v$から得られる）。レンダリング用にはこの連続関数を離散サンプルに変換する必要がある（＝テッセレーション）。

- サンプリング戦略（UVグリッド）  
  円柱：$u\in[0,2\pi)$（周方向）、$v$（高さ）で格子を敷き、各格子セルを2つの三角形にする。サンプル数は「滑らかさ⇄三角形数⇄処理コスト」のトレードオフ。実務目安：周方向32、ズーム時64〜128など。  
  球：経度・緯度の格子で同様。ただし極点ではUV行が一点に潰れるため、極部は四角をそのまま使うと劣化する。極では「扇形（三角形ファン）」として生成する。

- 平面と多角形（穴あり）の扱い  
  平面ポリゴンはトポロジーの頂点を使いファンで三角化できる。凸多角形は扇でOK（$$\text{三角形数}=n-2$$）。  
  穴（内側ループ）がある場合は、まず「ブリッジ」で内外ループを連結して単一の多角形に変換し、その後耳切り（ear clipping）で非凸多角形を三角化する。耳切りは「凸な三頂点」を見つけ、他頂点がその三角形内にないかをチェックして順次切り取るアルゴリズム。

- 出力フォーマット  
  最終的な成果物は典型的に以下の構造：  
  TriangleMesh { vertices: Vec<f32>, indices: Vec<u32> } — GPU／STL／物理エンジン互換。

## 実践ポイント
- サンプル数の目安：周方向32（一般用途）／64（拡大表示）／128（高品質）で性能と見た目を調整。  
- 極（ポール）処理：球の極は必ず扇（三角形ファン）にする。四角でそのままにすると細長いデグレードが出る。  
- 穴のある面：右端点→最短外周点でブリッジを張りループを一本化してから耳切りで三角化。  
- 精度：内部計算は$f64$で安定化し、最終頂点は$f32$に落とすのが現実的（GPU互換）。  
- 出力検証：生成メッシュはSTL/GLTFでエクスポートして法線・重複頂点・逆向き面をチェックする。  
- 実装ヒント：法線再計算とUV補間を忘れずに。パフォーマンス観点ではインデックスバッファを使い頂点共有を最大化する。

短く言えば、曲面の「見た目の滑らかさ」は適切なサンプリングと境界処理（極・穴・非凸）で作られる。テッセレーターは数学的表現をGPUが理解できる言葉（三角形）に翻訳する小さな魔法使いだ。
