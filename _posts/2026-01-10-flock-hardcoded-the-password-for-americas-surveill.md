---
layout: post
title: "Flock Hardcoded the Password for America's Surveillance Infrastructure 53 Times - Flockが米国の監視インフラの「パスワード」を53回も直書きしていた件"
date: 2026-01-10T00:25:25.341Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://nexanet.ai/blog/53-times-flocksafety-hardcoded-the-password-for-americas-surveillance-infrastructure"
source_title: "53 Times Flock Safety Hardcoded the Password for America&#x27;s Surveillance Infrastructure"
source_id: 46555807
excerpt: "Flockが監視地図のAPIキーを53回も直書きし大量監視データが丸裸に"
---

# Flock Hardcoded the Password for America's Surveillance Infrastructure 53 Times - Flockが米国の監視インフラの「パスワード」を53回も直書きしていた件
米国家の監視マップが、開発用の「デフォルトAPIキー」をフロントエンドに丸ごと露出していた――なぜこれが重大なのか。

## 要約
Flock SafetyがArcGISのデフォルトAPIキーを53箇所の公開JavaScriptバンドルに埋め込み、同キーで50のプライベート地図レイヤーにアクセスできる状態になっていた。これによりカメラ位置、ナンバープレート検知、巡回車両の位置、911通報など大量の監視データが理論上アクセス可能だった。

## この記事を読むべき理由
- インフラ系ソフトウェアや地図APIを扱う企業は同様のミスを起こしやすく、日本でも自治体や企業のプライバシー・セキュリティに直結する問題だから。  
- 初級エンジニアでも理解できる形で「なぜ起きたか」「どう防ぐか」が学べるから。

## 詳細解説
何が起きたか（簡潔）
- FlockはEsriのArcGISを地図基盤として使い、複数の法執行機関・コミュニティ・民間事業者のデータを統合して「1つのマップ」で可視化していた。  
- 調査では、ArcGISの「デフォルトAPIキー（サインアップ時に作成される恒久トークン）」がクライアント側のJavaScriptに埋め込まれて公開されていた。  
- そのキーはリファラー制限・IP制限・スコープ制限が設定されておらず、キー自体に50件分のプライベートアイテムへのアクセス権が付与されていたため、理論上は外部からその地図レイヤー群にアクセス可能だった。

なぜ重大か（データの性質）
- 暗黙の前提は「地図上のレイヤーがセキュアであること」。だが今回、カメラの設置場所や車両位置、ホットリスト、911通報の断片など、個人や捜査に関わるセンシティブな情報が共通マップに集約されていた。  
- 開発環境が公開され、本来プロダクションより広い権限を持っていた点も問題を拡大した。

原因の要点（技術的）
- クライアントサイドに秘密情報（恒久APIキー）を含めた  
- デフォルトキーをそのまま使用し、スコープ/リファラー制限を設定していない  
- 開発と本番のアクセス権管理が分離されていない・公開された開発サイトがあった  
- モニタリングやキーのローテーションが不十分だった

対応状況
- 一部の露出は責任ある開示を受けて修正されたが、報告から対応までに長期間を要した点が問題の深刻さを示している。

## 実践ポイント
すぐにできる対策（チェックリスト）
- 秘密情報はクライアントに置かない：APIキーやシークレットはサーバー経由のプロキシで扱う。  
- APIキーは最小権限＆短寿命に：スコープ（アクセス可能なリソース）を限定し、有効期間を短くする。  
- リファラー/IP制限を必ず設定：パブリックAPIキーでも利用ドメイン/IPを制限する。  
- 開発と本番を明確に分離：開発環境を公開する場合は本番用権限を与えない。  
- キーの管理とローテーション：インベントリ化して定期ローテーションと不要キーの削除を行う。  
- ログとアラート：不審なAPI利用や未知のクライアントからのアクセスを検知する仕組みを入れる。  
- 勤務者向けの教育と責任ある開示プロセスを整備：脆弱性報告を受け取る窓口と対応体制を準備する。

日本市場への示唆
- 地方自治体や警備系ベンダーも同様の地図連携を進めているため、公開前の権限チェックとデプロイプロセス整備は重要。個人情報保護法（APPI）や住民の信頼にも直結する問題なので、早めの体制整備を推奨する。

この記事から得られる教訓はシンプル：便利なクラウドAPIほど「設定ミスで脆弱になる」可能性が高い。小さな管理ルール（最小権限、非公開、監視）の徹底が大事故を防ぐ。
