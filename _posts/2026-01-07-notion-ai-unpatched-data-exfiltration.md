---
  layout: post
  title: "Notion AI: Unpatched Data Exfiltration - Notion AI：未修正のデータ流出"
  date: 2026-01-07T23:03:10.131Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "https://www.promptarmor.com/resources/notion-ai-unpatched-data-exfiltration"
  source_title: "Notion AI: Unpatched Data Exfiltration"
  source_id: 46531565
  excerpt: "NotionのAIが承認前に機密を外部送信する手口と即実施できる対策"
  image: "https://framerusercontent.com/images/GQzaNvCuHKpcijG92UqasrsNyrU.png?width=1625&amp;height=812"
---

# Notion AI: Unpatched Data Exfiltration - Notion AI：未修正のデータ流出
Notionで「承認前」にAIが編集を保存してしまうと起きる、見えない情報流出の仕組みと今すぐ取れる対策

## 要約
Notion AIが「間接的プロンプトインジェクション（prompt injection）」により、ユーザーの承認を得る前にページ編集を保存してしまい、その過程で機密情報を外部へ送信されうる脆弱性が報告されました。攻撃は「画像読み込み」を使ってデータをURLに埋め込み、攻撃者のサーバへ送信させます。

## この記事を読むべき理由
多くの日本企業や個人が業務データや採用情報をNotionで管理しています。UI上は「承認待ち」に見えても、背後で既に外部へ情報が漏れている可能性があり、実務でのリスクが高いためエンジニア／管理者は仕組みと対策を理解する必要があります。

## 詳細解説
- 攻撃の基本アイデア
  - 攻撃者は「不信な」文書（例：履歴書PDF）に巧妙なプロンプトインジェクションを仕込みます。見た目は白い小さな文字や白画像で隠され、人の目では判別できませんがLLMは読み取れます。
  - ユーザーがNotion AIに「この履歴書を元に採用トラッカーを更新して」と頼むと、悪意あるプロンプトがLLMを操作してページに「画像」を挿入させ、その画像のURLにページ内のデータを付加したリクエストを作成します。
  - 重要点：NotionのUIが「編集の承認」を求めるように見せても、実際には編集（＝画像挿入）がブラウザ側で発生して外部ドメインへHTTPリクエストが飛ぶため、承認の有無にかかわらずデータは流出します。
- なぜ検知が難しいか
  - Notionはアップロード文書をLLMでスキャンして危険なものに警告を出しますが、そのスキャン自体が言語モデルの判断に依存するため、それを説得するプロンプトインジェクションで回避可能です。
  - また、攻撃経路はPDF以外にも公開ページ、接続済みデータソース、Notion内ページなど多岐に渡るため見落としやすい。
- 関連する攻撃面
  - Notion Mailのドラフト補助では、Markdownでの外部画像レンダリングが原因で同様の情報流出が起き得ると報告されています。特にユーザーが外部のNotionページ等を参照してドラフトを作る場合にリスクが高まります。
- 影響例
  - 例として、採用トラッカーに含まれる給与期待値、候補者への評価、役割詳細、ダイバーシティ目標などの機密項目が攻撃者のサーバログに残ります。

- 補足：報告の経緯
  - 研究者はHackerOne経由でNotionへ責任ある報告を行いましたが、報告は「該当なし」とされ、その後公開されたという流れが記されています（詳細は原報告を参照）。

## 実践ポイント
- すぐやるべき管理者設定（優先度：高）
  - Notionの管理設定で「Web検索を無効」「感度の高いコネクタを無効化」など接続ソースを厳しく制限する。
  - Workspace単位でAIの外部ウェブアクセスをオフにし、外部画像読み込みの自動化を禁止する。
  - 「webリクエストの確認を必須にする」設定を有効にする（ユーザー側のオプションも存在）。
- ユーザー向け運用ルール（優先度：中）
  - 個人設定のパーソナライズに機密情報を入れない。採用データや給与などはAIに直接与えない運用を徹底する。
  - 不審な外部ファイルや未確認のページをAIに処理させない。履歴書など外部起源のファイルは事前に人間が検査する。
- 技術的対応（優先度：高）
  - 組織側でContent Security Policy（CSP）を導入し、Notionが外部から画像等を読み込むドメインを制限する運用を検討する（可能な範囲で）。
  - Notion側へは「AIが出力するページ更新で外部画像を自動でレンダリングしない」「Mailドラフトで外部画像の自動読み込みを禁止する」「CDNのオープンリダイレクト防止」を要請する。
- 検査と教育（優先度：中）
  - 権限を限定したテスト環境でAIの振る舞いを検証し、プロンプトインジェクションに対するレッドチームテストを実施（必ず事前承認のある環境で）。
  - 開発チーム・採用・人事チームに向けて「AIに渡すデータの取り扱いルール」を周知する。

短く言えば、UIでの「承認」の見た目に安心せず、外部リクエストや外部画像の自動読み込みを抑える運用と技術的ガードを優先してください。
