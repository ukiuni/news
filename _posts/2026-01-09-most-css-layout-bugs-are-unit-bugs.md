---
layout: post
title: "Most CSS layout bugs are unit bugs - ほとんどのCSSレイアウトバグは単位（unit）の問題である"
date: 2026-01-09T23:14:19.499Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://www.hexplain.space/blog/5Fc5g4A8IaHKXu2Yvs3F"
source_title: "Hexplain | Write. Discuss. Get Hired By Your Work"
source_id: 466815022
excerpt: "単位の誤用が生むCSSレイアウト崩れを見抜き、短時間で再発を防ぐ実践ガイド"
image: "https://hexplian.space/og-image.png"
---

# Most CSS layout bugs are unit bugs - ほとんどのCSSレイアウトバグは単位（unit）の問題である
魅力的なタイトル案: 単位が原因？CSSレイアウトの「謎バグ」を一発で見抜く法

## 要約
多くのCSSレイアウトの不具合は、px／%／rem／em／vhなど「単位」の使い分けや混在によるもの。単位の特性とブラウザの振る舞いを理解すれば、再現性の低いレイアウトバグを大幅に減らせる。

## この記事を読むべき理由
日本のウェブ制作では多様な画面サイズ（高DPIスマホ、デスクトップ、タブレット）とフォント設定、CMSによる外部スタイルの混入が常態化しています。単位が原因のバグを防げれば、保守負荷とデザイン崩れを劇的に低減できます。

## 詳細解説
単位バグとは「期待した寸法や比率が出ない」「ある環境だけ崩れる」といった現象の多くが、使っている単位の意味と計算タイミングの違いに起因していることを指します。主なポイントは次の通りです。

- 相対単位の基準が違う  
  - rem はルート（html）のフォントサイズ基準、em は要素自身または親のフォントサイズ基準。想定と違う基準が適用されると意図せぬ拡大縮小が起きる。  
- % の参照対象はプロパティによって変わる  
  - width の % は親要素のコンテンツ幅基準。padding や top/right/left の % は別の基準（親の幅など）を使うことがあり、混在でズレが生じる。  
- ビューポート単位（vh/vw）とブラウザUIの影響  
  - モバイルブラウザのアドレスバー表示によって vh の値が変化し、意図しないスクロールや重なりを生む。  
- 小数点とサブピクセルレンダリング  
  - ブラウザはピクセルに丸めるため、複数要素の合算で1pxずつズレてボックスがはみ出す（特に横並びのグリッドや境界線）。  
- 単位レス(Line-height)とフォントの関係  
  - line-height を単位なしにするとフォントサイズに対する比率で計算され、フォント変更でレイアウトが崩れにくい反面、固定pxが必要な場面で誤差が出る。  
- トランスフォームとレイアウト単位の違い  
  - transform: translateX(50%) は自身の幅を基準にする一方、left: 50% は親の幅を基準にする。見た目は似ていても動作が別。

実際のバグ例（言葉で説明）
- ナビのアイテムが1pxずつはみ出す：flex アイテムに%幅＋borderで合計が100%を超え、サブピクセル丸めで発生することが多い。  
- フォントサイズ変更で段落がはみ出す：子要素で px を使い親で rem を使うと相対関係が壊れる。  
- モバイルでvh指定のヘッダが画面外に飛ぶ：アドレスバー表示で vh が動的に変わることが原因。

## 実践ポイント
すぐに試せる対策リスト：
1. 基本ルールを決める  
   - プロジェクトで「タイポはrem、間隔はremかpx、幅は%／flex／grid」のような単位ポリシーを統一する。  
2. rem をルートに一本化（必要に応じて）  
   - 全体のレスポンシブ調整は html の font-size を変えることで制御しやすくなる。  
3. % と calc() を混ぜるときは参照基準を確認する  
   - calc(100% - 24px) のような式は親幅が基準だと理解しておく。  
4. モバイルでの vh は慎重に  
   - min-height: 100dvh や JSで計測したカスタムプロパティで代替する（ブラウザ差に注意）。  
5. サブピクセル問題は box-sizing と gap で緩和  
   - box-sizing: border-box を標準にし、余白は gap に移行すると合算ミスが減る。  
6. デバッグ手順を定める  
   - 疑わしい要素に一時的に outline と background-color を設定して参照領域を可視化。DevToolsの「Computed」や「Layout」タブで基準を確認。  
7. テストを自動化する  
   - 異なるDPRやフォント設定、縮尺でのスクリーンショット比較テストを導入して早期検出。

日本市場向けの補足
- モバイルファースト文化と高DPI端末の普及により、単位バグはユーザー体験に直結します。特にECやメディア系では表示崩れがコンバージョン低下に直結するため、単位ポリシーの運用はコスト対効果が高い投資です。

以上を踏まえ、まずはプロジェクトの単位ルールを1つ決めて、既存のコンポーネントに対してリグレッションテストを回してください。単位を意識するだけで「直感的には合っているのに崩れる」バグの多くは防げます。
