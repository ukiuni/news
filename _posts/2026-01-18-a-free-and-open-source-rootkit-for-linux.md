---
layout: post
title: "A free and open-source rootkit for Linux - Linux向けのフリーかつオープンソースなルートキット"
date: 2026-01-18T15:57:31.914Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://lwn.net/SubscriberLink/1053099/19c2e8180aeb0438/"
source_title: "A free and open-source rootkit for Linux [LWN.net]"
source_id: 46666288
excerpt: "Linux用オープンルートキットSingularity公開、検出回避の脅威と防御ポイント解説"
---

# A free and open-source rootkit for Linux - Linux向けのフリーかつオープンソースなルートキット
驚愕の“研究用”ルートキット公開――「防御側が知らない技」を丸見えにする危うさと学び

## 要約
Linuxカーネル上で稼働するオープンソースのルートキット「Singularity」が公開され、検出回避の手法を研究目的で示した。悪用リスクがある一方、検知・防御の研究にとっては重要な実験台になる。

## この記事を読むべき理由
攻撃側がどのようにカーネルに潜伏して観測をすり抜けるかを知ることは、防御側の設計（EDR、サーバ運用、監査）を強化する上で必須。日本の企業・開発現場でも現実的な脅威となりうるため、IT運用者やセキュリティ担当は概要を押さえておく必要がある。

## 詳細解説
- 研究の位置づけ：公開者は研究目的を強調しており、不正利用を戒めている。コードはオープンライセンスで公開されているため、解析や検知手法の検証に使える。
- カーネル内での「隠れ方」：Singularityはカーネルの既存トレース機構を利用して、システムコールの挙動を書き換える（＝見かけ上の応答を改変する）ことで自身の存在や攻撃者プロセス、ファイル、通信を隠す。従来の機械語を直接書き換える手法と異なり、検出が難しくなる点が特徴。
- プロセス・ファイルの隠蔽：隠す対象を内部リストで管理し、カーネルが返すプロセス数やディレクトリエントリを改変して「存在しない」ように見せる。ファイルシステムの整合性を保つため、参照カウント等の値も補正する工夫があるが、完全ではなくフォレンジック調査で痕跡が残る場合がある。
- ネットワーク遮断回避：特定の通信をパケットキャプチャ等から除外する仕組みを持つ。ただし、攻撃者側が制御していない別の機器でネットワークを監視していれば検出される。
- 互換性と検出難易度：32/64ビットのシステムコール差異に対応するなど互換性に配慮。カーネルの内部構造に依存するためカーネル更新で動作が壊れる可能性もある。
- 運用上の注意点：Singularity自身はロード後に消える（アンロード不可）などの挙動があり、実験は仮想環境で行うべきとされている。

（補足）記事は技術的な仕組みを解説するが、具体的な悪用手順やインストール手法はここでは扱わない。目的は防御・検知の理解を深めることにある。

## 実践ポイント
- 研究目的で扱う場合は必ず明示的許可のある隔離環境（VM・検証ラック）で実験する。
- カーネルのトレーシング機能やモジュール一覧の整合性監視を導入し、通常と異なる挙動（無効化できないトレース設定やモジュール一覧の不整合）を検出トリガーにする。
- 重要な調査はオフラインでのフォレンジック（別マシンからのディスク解析）を併用する。ランニングカーネル上の隠蔽は、ライブ調査だけでは見落とすリスクがある。
- モジュール署名やSecure Boot、最小権限の原則を徹底して、カーネル改変の難易度を上げる。
- 開発・運用チームは「攻撃者がカーネルで何をできるか」を理解し、EDRやログ設計、障害時の再現手順を見直すことで早期検出・復旧を目指す。

この記事は、攻撃手法の具体的な再現を助長することを目的としていません。防御のために知るべきポイントを整理することを意図しています。
