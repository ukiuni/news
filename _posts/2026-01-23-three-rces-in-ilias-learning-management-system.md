---
layout: post
title: "Three RCEs in Ilias Learning Management System - ILIAS学習管理システムの3件のRCE脆弱性"
date: 2026-01-23T17:07:52.468Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://srlabs.de/blog/breaking-ilias-part-2-three-to-rce"
source_title: "Breaking ILIAS #2: Three to RCE - SRLabs Research"
source_id: 46733899
excerpt: "ILIASで3件のRCE、公開領域経由でサーバ完全掌握の危険—今すぐパッチ確認を"
image: "https://srlabs.de/_app/immutable/assets/cover.Ec8wu09B.png"
---

# Three RCEs in Ilias Learning Management System - ILIAS学習管理システムの3件のRCE脆弱性
公開スペースから「サーバ全権を奪われる」可能性──ILIASに見つかった3つのRCEの教訓

## 要約
ILIAS（バージョン8–10）で公開領域や輸入機能を狙う3件のリモートコード実行（RCE）が報告・修正されました。いずれも「アクセス制御の不備」「ZIP処理の例外未処理」「安全でないデシリアライズ」が原因です。

## この記事を読むべき理由
日本の大学・教育事業者やLMS運用担当者にとって、公開コンテンツやインポート機能を通じた完全なサーバ侵害は現実的なリスクです。既知のCVEがあるため、早急な確認と対応が必要です。

## 詳細解説
- 概要  
  - 3件の問題はそれぞれ発見経路と条件が異なりますが、最終的に任意コード実行に至る点で共通しています。ベンダーには責任ある開示で報告され、公開パッチが提供されています。

- 主要な技術的原因（高レベル）
  1. アンオーセンティケイテッドRCE（公開オブジェクトを悪用）  
     - コース用の証明書テンプレート取り込み処理で、想定外のZIP構造による例外発生時に抽出ファイルのクリーンアップが行われず、webからアクセス可能なディレクトリに悪意ファイルが残る点を突かれました。さらにApacheのディレクトリ設定（.htaccessの継承）で動作を上書きできるため、最終的にサーバ側でコード実行され得ました。  
  2. 認証済みRCE（不安全なデシリアライズ）  
     - インポート処理内で外部に依存するライブラリクラス（例：一般的なComposerパッケージ）を含む状態で、攻撃者制御のデータをunserialize()に渡してしまう実装により、既存の「ガジェット」クラスのマジックメソッドを経由して任意処理が走る可能性がありました。  
  3. 認証済みRCE（URLパラメータ経由のデシリアライズ）  
     - ファイル不要で、パラメータに埋め込んだシリアライズ文字列を復号・実行させるパスが存在しました。

- 影響  
  - 条件次第で完全なサーバ掌握（root/任意コマンド実行）に至る可能性。公開領域に該当オブジェクトがあると未認証でも危険。

## 実践ポイント
- まずアップデート：ベンダー提供のパッチ（該当CVE対応）を速やかに適用する。  
- 公開領域の確認：Test/Course等のオブジェクトが公開スペースに置かれていないか監査する。  
- アップロード/解凍の安全化：アップロードされたZIPは絶対にwebroot直下で展開しない。展開後は必ず例外含めてクリーンアップ処理を確実に行う。  
- Webサーバ設定：データ保存ディレクトリでの. htaccessによる挙動上書きを許可しない（AllowOverride None 等）／拡張子ごとの実行指定を避ける。  
- デシリアライズ対策：unserialize()の使用を避けるか、allowed_classes等で制限する。外部依存ライブラリに危険なガジェットがないか依存関係を見直す。  
- 権限設計とログ監視：管理・インポート権限を最小化し、不審なアップロードやダウンロード要求を収集・検知する。  
- 定期的なセキュリティレビュー：LMSの公開設定、プラグイン、Composer依存を定期監査すること。

（参考：SRLabsが公開した報告に基づく要約。具体的なエクスプロイト手順やPoCは省略しました。運用者は公式アドバイザリとパッチノートを参照してください。）
