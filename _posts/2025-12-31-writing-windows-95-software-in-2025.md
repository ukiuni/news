---
layout: post
title: "Writing Windows 95 software in 2025 - 2025年にWindows 95向けソフトを書く"
date: 2025-12-31T23:37:51.788Z
categories: [tech, world-news]
tags: [tech-news, japan]
source_url: "https://tlxdev.hashnode.dev/writing-windows-95-software-in-2025"
source_title: "Writing Windows 95 software in 2025"
source_id: 474099929
excerpt: "エミュレータと旧コンパイラで実機代替し、Win95向けアプリを安全に構築・検証する実践ガイド"
---

# Writing Windows 95 software in 2025 - 2025年にWindows 95向けソフトを書く
なぜ「いま」Win95向け？レトロ実務派のための実戦ガイド

## 要約
2025年にWindows 95向けソフトを作るには、レトロ環境の制約（API・ツールチェーン・テスト環境）を理解し、エミュレーションや古いコンパイラ／互換ツールを組み合わせて開発・検証するのが現実的なアプローチです。

## この記事を読むべき理由
古い工場システムやPOS、レトロPC愛好家のプロジェクトなど、日本でも「古いWindows環境」を維持・改修する需要は根強く、実用的な対処法を知っておくと現場で役立ちます。セキュリティや移行計画を検討する技術者にも必読です。

## 詳細解説
- 技術的背景  
  - Windows 95は当時のWin32 API（ただしUnicode/新APIは限定的）やGDI、古いコモンコントロールを想定しています。最新のCRTやランタイムに依存すると動作しません。  
  - 32bit PE実行形式だが、APIセットは現代OSより制限される。特にUnicode, XP以降の拡張APIやUAC、SxSは期待できません。  
  - 開発環境は現代と異なり、Visual C++ 6.0など旧コンパイラやOpen Watcom、MinGW系（i686ターゲット）を検討。古いCRTを使うか、最小限の依存に抑えることが肝要です。

- ツールとビルドのポイント  
  - コンパイラ: Open Watcom はレトロ環境向けの選択肢。MinGW/MinGW‑w64でi686ターゲットを使えば32bit PEが作れるが、リンクするAPIに注意。  
  - リソース: .rc/.res といった古典的リソースツールを使い、アイコン・ダイアログは古仕様に合わせる。  
  - 文字コード: Win95はANSI APIが中心。Unicode化は限定的で互換性リスクあり。コードはマルチバイト（Shift_JIS）対応を検討。  
  - 互換性: 新しいランタイム関数を使わない、動的ロード(LoadLibrary/GetProcAddress)でフォールバック実装を用意する。  

- テストと実行環境  
  - 実機は入手困難かつ壊れやすい。代わりにVM（VirtualBox）やエミュレータ（PCem、86Box）、Wineで検証。ネットワークやDOSデバイスのエミュレーションが必要ならPCem/86Boxが有効。  
  - CI環境ではVMイメージを用意して自動テストを回す。Docker上でWineを使う簡易チェックも有効だが完全互換は保証されない。

- 法的・運用面  
  - 古いMicrosoft SDKやツールの配布・利用条件を確認する。商用での再配布はライセンスに注意。  
  - セキュリティ面でWin95は脆弱。ネット接続を行うなら隔離やプロキシ、ファイアウォールの適用が必須。

## 実践ポイント
- 開発環境を構築する順序  
  1. 開発用仮想マシン（Windows 95）をPCem/VirtualBoxで用意。スナップショットを必ず作成。  
  2. 目的に応じたコンパイラを選定（Open Watcom / MinGW(i686) / 古いMSVC）。まず最小構成でHello Worldを動かす。  
  3. リソース編集、アンチアルゴリズム（動的API解決）を実装して互換性を確保。  
  4. 実機／エミュでUI・描画・入出力を重点的にテスト。Shift_JISなど文字コードの表示を確認。  

- 移行を視野に入れる  
  - 可能なら段階的にモダン化（例えばバックエンドを現代のサーバへ移し、Win95側は最小限のフロントエンドとして維持）する設計が現実的。  
  - 長期的にはQtやクロスプラットフォーム技術へ移植するコストも算出して比較する。

- 日本市場での実務的提案  
  - レガシー資産の棚卸しを行い、サポート継続のリスク／コストを可視化する。  
  - 工場や流通現場の機器はオフライン化やネットワーク分離で脆弱性を緩和する。移行プロジェクト提案の余地あり。

