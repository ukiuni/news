---
  layout: post
  title: "Why I switched away from Zig to C3 - ZigからC3へ乗り換えた理由"
  date: 2026-01-02T12:04:09.125Z
  categories: [tech, world-news]
  tags: [tech-news, japan]
  source_url: "https://lowbytefox.dev/blog/from-zig-to-c3/"
  source_title: "Why I switched away from Zig to C3"
  source_id: 472954340
  excerpt: "ZigよりCに近い操作感で契約や一時アロケータ等の実用機能を備えたC3への乗り換え理由"
  image: "https://lowbytefox.dev/blog/from-zig-to-c3/thumbnail.png"
---

# Why I switched away from Zig to C3 - ZigからC3へ乗り換えた理由
Cライクな軽量モダン言語「C3」が示す“Cの延長上にある生産性” — Zigで得られなかった手触りを求めるエンジニアへ

## 要約
ZigからC3へ移行した理由は、「Cの直感性を保ちつつ、実用的な言語機能（一時アロケータ、柔軟なモジュール、インターフェース式の動的呼び出し、契約）を提供する」点にある。小〜中規模のシステムやツール作成で実戦的な利便性をもたらす。

## この記事を読むべき理由
日本の組込み／ゲーム／ツール開発ではCやC系言語が根強く残る。Zigの代替を探している、あるいは「よりCに近いが機能的には改善された言語」を試したい技術者にとって、C3は実務で即戦力になりうる具体的な特徴と注意点を示す。

## 詳細解説
- 一時アロケータ（@pool）  
  スコープを抜けると自動で一時領域を解放する仕組み。Arenaを手動で初期化/解放する手間を省けるため、短期バッファやパース処理が簡潔に書ける。例：
  ```c3
  fn void foo() {
    @pool() {
      bar();
    } // bar 内で行われた一時割当はここで解放される
  }
  ```

- 柔軟なモジュール設計  
  ファイル単位だけでなく、モジュールは分割・拡張可能。C++のnamespaceに近い形で複数ファイルへ分散でき、importは再帰的にサブモジュールも読み込む。

- メソッドと型拡張  
  メソッドは関数風だが型名の接頭辞で紐づけられ、ドット呼び出しが可能。既存型へのメソッド追加や複数ファイルからの拡張が許される点が柔軟。

- インターフェースと動的呼び出し（@dynamic / @optional）  
  インターフェースは暗黙的にポインタで扱え、実装チェックはコンパイル時に行われる（ただし既存型にあとから適用した場合は静的チェックの恩恵が薄い）。動的メソッド呼び出しや、実装が任意のメソッド検査が可能で、ポリモーフィズムを手軽に扱える。

- 契約（Contracts）  
  @require / @ensure風のアノテーションで前提／事後条件を記述。実行時チェックはコンパイラの最適化設定や「safe mode」に依存するため、デバッグ時の検査有効化が推奨される。

- 注意点（Quirks）  
  - enumのデフォルト挙動はCと完全互換ではなく、C互換が欲しい場合は"const enum"を明示する必要がある。  
  - C3のOptionalsは「値＋理由（Excuse）」を返す設計で、伝統的なNone/Someの意味合いとは異なる（RustのResultに近い）。  
  - 一部API実装における振る舞い（例：パイプをファイル扱いしてしまうio/streamのavailable実装）に注意。標準ライブラリの実装を読んで動作保証を確認する習慣が必要。

## 実践ポイント
- 小さなユーティリティ／ツールから試す：言語のメモリモデルや標準ライブラリのクセを早期に把握するのが安全。  
- @poolを活用して一時バッファを簡潔に：文字列処理やパーサで効果大。  
- インターフェース実装は明示的に行い、動的呼び出し前に存在チェックを行う習慣をつける。  
- コンパイル時の「safe mode」を有効にして契約チェックを有効化し、テストフェーズで振る舞いを検証する。  
- 標準ライブラリ（io/stream 等）やABI互換の箇所はソースを読み、Cとの相互運用で期待とズレがないか確認する。  
- コミュニティ（DiscordやGitHub）でのやり取りが活発なので、実装上の疑問はIssueやPRで改善に貢献すると学びが早い。

